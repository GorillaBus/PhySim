{"version":3,"sources":["node_modules/browser-pack/_prelude.js","projects/collisioner/app.js","projects/collisioner/interactions.js","projects/collisioner/lib/Mapper.js","projects/collisioner/lib/MapperLayer.js","projects/collisioner/lib/MapperRegion.js","projects/collisioner/lib/ParticleExt.js","projects/collisioner/lib/ParticleManager.js","projects/collisioner/matter.js","src/feature-toggle.js","src/lib/AnimationPlayer.js","src/lib/Particle.js","src/lib/Utils.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import Utils from '../../src/lib/Utils';\nimport AnimationPlayer from '../../src/lib/AnimationPlayer';\nimport ParticleManager from './lib/ParticleManager';\nimport Matter from './matter';\n\nwindow.onload = () => {\n\n  const canvas = document.getElementById(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  const width = window.innerWidth;\n  const height = window.innerHeight-4;\n  const center = { x: width/2, y: height/2 };\n\n  canvas.height = height;\n  canvas.width = width;\n\n\n  // World settings\n  const G = 9.8;\n  let world = {\n    G: G\n  };\n\n\n  let player = new AnimationPlayer({ fps: 60 });\n\n\n  // Create particle fixtures\n  let particlesFixtures = new Array(900);\n  let matterTypes = Object.keys(Matter)\n  let neutralTypeIndex = matterTypes.indexOf('neutral');\n  matterTypes.splice(neutralTypeIndex, 1);\n  let totalMatterTypes = matterTypes.length;\n\n  for (let i=0; i<particlesFixtures.length; i++) {\n\n    let randomMatter = Math.floor(Math.random() * totalMatterTypes) + 0;\n    let matterType = matterTypes[randomMatter];\n\n    let p = {\n        x: Utils.randomRange(50, width-50),\n        y: Utils.randomRange(50, height-50),\n        mass: Utils.randomRange(3, 5),\n        direction: Utils.randomRange(-1, 1),\n        //speed: Utils.randomRange(2, 5),\n        matter: matterType,\n        boxBounce: { w: width, h: height }\n    };\n\n    particlesFixtures[i] = p;\n  }\n\n  // particlesFixtures[0] = {\n  //   x: center.x-40,\n  //   y: center.y,\n  //   mass: 148,\n  //   matter: \"iron\",\n  //   direction: Math.PI*2,\n  //   //speed: 0.9,\n  //   boxBounce: { w: width, h: height }\n  // };\n  //\n  // particlesFixtures[1] = {\n  //   x: center.x+100,\n  //   y: center.y,\n  //   mass: 3,\n  //   matter: \"air\",\n  //   direction: Math.PI,\n  //   //speed: 1.3,\n  //   boxBounce: { w: width, h: height }\n  // };\n\n  let pmanager = new ParticleManager({\n    debug: false\n  }, world, ctx);\n\n  // Create interaction maps\n  // TODO: Check what happens with duplicated layers.\n  let collisionRegionSize = 200;\n  let gravityRegionSize = width;\n  pmanager.addInteractionMap('collision', collisionRegionSize, 'collision');\n  pmanager.addInteractionMap('gravity', gravityRegionSize, 'gravity');\n\n  // Add particlesFixtures into the Mapper\n  pmanager.addParticles(particlesFixtures);\n\n  // Demo player setup\n  player.setUpdateFn(update);\n  //player.play();\n\n\n  // Frame drawing function\n  function update() {\n\n    // Update particle's state\n    pmanager.update();\n\n    // Clear full screen\n    ctx.clearRect(0,0, width, height);\n\n    // Global draw\n    pmanager.draw();\n  }\n\n};\n","export default {\n  'gravity': (a, b) => {\n    a.gravitateTo(b);\n  },\n  'collision': (a, b) => {\n    let collision = a.collisionCheck(b);\n    if (collision) {\n      a.collisionHandle(b, collision);\n    }\n  }\n}\n","import Interactions from '../interactions';\nimport Utils from '../../../src/lib/Utils';\nimport Layer from './MapperLayer';\n\nexport default class Mapper {\n\n  constructor() {\n    this.layers = [];\n    this.layerIndex = {};\n  }\n\n  /*\n   *  Creates a new Layer in the Mapper\n   */\n  addLayer(id, regionSize, interactionFn) {\n\n    if (typeof interactionFn === 'string' && Interactions.hasOwnProperty(interactionFn)) {\n      interactionFn = Interactions[interactionFn];\n    } else {\n      console.warn('Mapper.addLayer: '+ interactionFn +' is not a predefined Interaction');\n    }\n\n    let layer = new Layer({\n      id: id,\n      regionSize: regionSize,\n      interactionFn: interactionFn\n    });\n\n    this.layers.push(layer);\n    this.layerIndex[id] = layer;\n\n    return this.layerIndex[id];\n  }\n\n  /*\n   *  Registers a particle in all the qualified regions of each Mapper Layer\n   */\n  register(p) {\n    let mapperData = [];\n    let totalLayers = this.layers.length;\n    let points = Utils.getCirclePoints(p);\n    let totalPoints = points.length;\n\n    for (let x=0; x<totalLayers; x++) {\n      let layer = this.layers[x];\n      let qualifiedRegions = [];\n\n      this.unregister(p);\n\n      for (let i=0; i<totalPoints; i++) {\n        let regionData = this.qualifyPoint(points[i], layer.id);\n        let totalQualified = qualifiedRegions.length;\n        let exists = false;\n\n        for (let z=0; z<totalQualified; z++) {\n          if (qualifiedRegions[z].id === regionData.id) {\n            exists = true;\n            continue;\n          }\n        }\n\n        if (!exists) {\n          if (!layer.regionIndex.hasOwnProperty(regionData.id)) {\n            layer.addRegion(regionData)\n          }\n\n          let region = layer.regionIndex[regionData.id];\n          region.subscribe(p);\n          qualifiedRegions.push(region);\n        }\n      }\n\n      mapperData.push({\n        id: layer.id,\n        regions: qualifiedRegions\n      });\n    }\n\n    p.mapperData = mapperData;\n  }\n\n  /*\n   *  Unsubscribe particle from every Layer/Region and reset particle's mapper data\n   */\n  unregister(p) {\n    let totalLayers = p.mapperData.length;\n    for (let i=0; i<totalLayers; i++) {\n      let layerID = p.mapperData[i].id;\n      let totalRegions = p.mapperData[i].regions.length;\n      for (let r=0; r<totalRegions; r++) {\n        p.mapperData[i].regions[r].unsubscribe(p);\n      }\n    }\n\n    this.reset(p);\n  }\n\n  /*\n   *  Deletes all mapepr data from Particle\n   */\n  reset(p) {\n    p.mapperData = [];\n  }\n\n  /*\n   *  Qualifies a single point into a Layer Region\n   */\n  qualifyPoint(pt, layerId) {\n    let regionSize = this.layerIndex[layerId].regionSize;\n    let xComponent = pt.x > regionSize ? Math.floor(Math.abs(pt.x / regionSize)):0;\n    let yComponent = pt.y > regionSize ? Math.floor(Math.abs(pt.y / regionSize)):0;\n    let data = {\n      id: null,\n      x: xComponent * regionSize,\n      y: yComponent * regionSize\n    };\n    data.id = xComponent + \"_\"+ yComponent;\n    return data;\n  }\n}\n","import Region from './MapperRegion';\nimport Utils from '../../../src/lib/Utils';\n\nexport default class MapperLayer {\n\n  constructor(settings) {\n    this.id = settings.id;\n    this.regionSize = settings.regionSize;\n    this.regions = [];\n    this.regionIndex = {};\n    this.interaction = settings.interactionFn;\n    this.color = Utils.randomColor();\n  }\n\n  /*\n   *  Creates a new Region in the Mapper\n   */\n  addRegion(regionData) {\n    let region = new Region({\n      id: regionData.id,\n      x: regionData.x,\n      y: regionData.y,\n      size: this.regionSize,\n      layer: this\n    });\n\n    this.regions.push(region);\n    this.regionIndex[regionData.id] = region;\n  }\n\n  /*\n   *  Iterates all Layer Regions and fires it's interaction function\n   */\n  iterate() {\n    let totalRegions = this.regions.length;\n    for (let x=0; x<totalRegions; x++) {\n      this.regions[x].interact();\n    }\n  }\n}\n","export default class MapperRegion {\n\n  constructor(settings) {\n    this.id = settings.id;\n    this.x = settings.x;\n    this.y = settings.y;\n    this.size = settings.size;\n    this.layer = settings.layer;\n    this.particles = [];\n    this.totalParticles = 0;\n    this.particleIndex = {};\n  }\n\n  /*\n   *  Subscribes a Particle to the Region\n   */\n  subscribe(p) {\n    this.particles.push(p.id);\n    this.particleIndex[p.id] = p;\n    this.totalParticles++;\n  }\n\n  /*\n   *  Unsubscribes a Particle from the Region\n   */\n  unsubscribe(p) {\n    delete this.particleIndex[p.id];\n    let index = this.particles.indexOf(p.id);\n    this.particles.splice(index, 1);\n    this.totalParticles--;\n  }\n\n  /*\n   *  Iterates through al particles running the interaction function\n   */\n  interact() {\n    for (let i=0; i<this.totalParticles; i++) {\n      let A = this.particleIndex[this.particles[i]];\n      for (let y=0; y<this.totalParticles; y++) {\n        let B = this.particleIndex[this.particles[y]];\n        if (A.id === B.id) {\n          continue;\n        }\n        this.layer.interaction(A, B);\n      }\n    }\n  }\n\n  /*\n   *  Draws the region on screen (debugging)\n   */\n  draw(ctx) {\n    ctx.beginPath();\n    ctx.strokeStyle = \"#FFFFFF\";\n    ctx.fillStyle = this.layer.color;\n    ctx.rect(this.x, this.y, this.layer.regionSize, this.layer.regionSize);\n    ctx.fill();\n    ctx.stroke();\n    ctx.closePath();\n  }\n}\n","import FEATURE_TOGGLE from '../../../src/feature-toggle';\nimport Particle from '../../../src/lib/Particle';\nimport Matter from '../matter.js';\n\n\nexport default class ParticleExt extends Particle {\n\n    constructor(settings) {\n      super(settings);\n\n      this.matter = Matter[settings.matter] || Matter.neutral;\n      this.color = this.matter.color;\n      this.radius = this.mass / this.matter.density;\n      this.mapperData = [];\n      this.points = settings.points || [];\n    }\n\n    draw(ctx) {\n      ctx.beginPath();\n      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);\n      ctx.fillStyle = this.color;\n      ctx.fill();\n      ctx.closePath();\n    }\n\n    debugDrawNextPosition(ctx) {\n      let x = this.x;\n      let y = this.y;\n      let vx = this.vx;\n      let vy = this.vy;\n\n      vy += this.gravity;\n      vx *= this.friction;\n      vy *= this.friction;\n\n      x += vx;\n      y += vy;\n\n      ctx.beginPath();\n      ctx.arc(x, y, this.radius, 0, Math.PI * 2, false);\n      ctx.strokeStyle = this.color;\n      ctx.stroke();\n\n      ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n      ctx.moveTo(this.x, this.y);\n      ctx.lineTo(x, y);\n      ctx.stroke();\n      ctx.closePath();\n    }\n\n    /*\n     *  Adds to the velocity vector dividing by the mass\n     */\n    applyForce(f) {\n      this.vx += f.x / this.mass;\n      this.vy += f.y / this.mass;\n    }\n\n    /*\n     *  Calculates and applies a gravitation vector to a given particle\n     */\n     gravitateTo(p, gravityFactor) {\n         gravityFactor = gravityFactor || 0.1;\n\n         let radiusSum = this.radius + p.radius;\n         let massFactor = this.mass * p.mass;\n\n         let dx = p.x - this.x;\n         let dy = p.y - this.y;\n         let distSQ = (dx * dx) + (dy * dy);\n         let dist = Math.sqrt(distSQ);\n         let surfaceDist = dist - radiusSum;\n\n         // Cancel gravitation once objects collide\n         // TODO: Verify if we can save the Math.sqrt() comparing squares\n         if (dist < radiusSum) {\n           return;\n         }\n\n         let force = gravityFactor * massFactor / (dist * dist);\n\n         let gravityVector = {\n           x: (dx / dist) * force,\n           y: (dy / dist) * force\n         };\n\n         this.applyForce(gravityVector);\n     }\n\n    /*\n        Check for Circle-Circle collisions and return details\n    */\n    collisionCheck(p) {\n      // Get the Distance vector (difference in position)\n      let xDist = this.x - p.x;\n      let yDist = this.y - p.y;\n\n      // We'll save a Math.sqrt() to verify distances like this:\n      let distSquared = xDist*xDist + yDist*yDist;\n      let radiusSquared = (this.radius + p.radius) * (this.radius + p.radius);\n\n      // Collision check\n      if (distSquared < radiusSquared) {\n\n        // Once collided, get the Displacement vector (difference in velocity)\n        let xVelocity = p.vx - this.vx;\n        let yVelocity = p.vy - this.vy;\n\n        // Project the Collision vector over the Distance vector\n        let dotProduct = xDist*xVelocity + yDist*yVelocity;\n\n\n        /*\n         *\n         *\n         *  Hi, welcome to this \"Dot Product\" implementation 101.\n         *\n         *    Dot Product will tell if both particles ara heading one to the other, and if they are\n         *    actually colliding or will collide in the future.\n         *\n         *    Think of it as if we where calculating the difference in Distance (or position) and\n         *    the difference in Speed (lenth) of both objects. To do this, we substract vector values.\n         *\n         *    When the difference in angles and speeds between the two moving objects are both:\n         *\n         *    Negative: NO collision; maybe exact oposite direction but still yet\n         *              too far to collide -at this time (maybe next tick)\n         *\n         *    Cero:     COLLISION; a perfect collision in direction, acceleration and time\n         *\n         *    Positive: COLLISION; exact direction; and the resulting force from the collision\n         *\n         *\n         */\n        if (dotProduct > 0) {\n\n          // The resulting force from the collision (angle difference + velocity difference)\n          let collisionScale = dotProduct / distSquared;\n\n          // // Collision Vector:\n          let collision = {\n            x: xDist * collisionScale,\n            y: yDist * collisionScale\n          };\n\n          return collision;\n        }\n      }\n\n      return false;\n    }\n\n    /*\n        2D Elastic collision handling\n    */\n    collisionHandle(p, collisionVector) {\n\n      // 2D-Elastic collision formula\n      let combinedMass = this.mass + p.mass;\n      let collisionWeight0 = (2 * p.mass / combinedMass) * p.matter.restitution;\n      let collisionWeight1 = (2 * this.mass / combinedMass) * this.matter.restitution;\n\n      // Adds the computed collision results to the velocities of this / p\n      this.vx += collisionWeight0 * collisionVector.x;\n      this.vy += collisionWeight0 * collisionVector.y;\n      p.vx -= collisionWeight1 * collisionVector.x;\n      p.vy -= collisionWeight1 * collisionVector.y;\n    }\n}\n","import Utils from '../../../src/lib/Utils';\nimport Particle from './ParticleExt';\nimport Mapper from './Mapper';\n\nexport default class ParticleManager {\n\n  constructor(settings, world, ctx) {\n    this.world = world;\n    this.ctx = ctx;\n    this.mapper = new Mapper();\n    this.interactionMaps = [];\n    this.particles = [];\n    this.DEBUG_MODE = settings.debug || false;\n  }\n\n  /*\n   *  General Mapper update method\n   */\n  update() {\n    this.updateParticles();\n    this.runInteractions();\n  }\n\n  /*\n   *  Debugging: draws all regions and total particles on screen\n   */\n  debugDrawRegions(displayParticleCount) {\n    let totalLayers = this.mapper.layers.length;\n    let body = document.getElementsByTagName(\"BODY\")[0];\n\n    for (let i=0; i<totalLayers; i++) {\n      let layer = this.mapper.layers[i];\n      let totalRegions = layer.regions.length;\n\n      for (let x=0; x<totalRegions; x++) {\n        let region = layer.regions[x];\n\n        // Skip empty regions\n        if (region.totalParticles > 0) {\n          region.draw(this.ctx);\n\n          if (displayParticleCount) {\n            let docFragment = document.createDocumentFragment();\n            let obj;\n\n            if (!(obj = document.getElementById(region.id))) {\n              obj = document.createElement(\"p\");\n              obj.innerHTML = region.totalParticles;\n              obj.id = region.id;\n              obj.style.position = \"absolute\";\n              obj.style.left = (region.x + 2) +\"px\";\n              obj.style.top = (region.y - 5) + \"px\";\n              obj.style.fontSize = \"0.5em\";\n              obj.style.color = \"#FFFFFF\";\n\n              docFragment.appendChild(obj);\n              body.appendChild(docFragment);\n            }\n\n            obj.innerHTML = region.totalParticles;\n          }\n        }\n      }\n    }\n  }\n\n  /*\n   *  Update particle's state\n   */\n  updateParticles() {\n    let totalParticles = this.particles.length;\n    for (let i=0; i<totalParticles; i++) {\n      let p = this.particles[i];\n\n      // Update particle position\n      p.update();\n\n      // Register particle in the Mapper\n      this.mapper.register(p);\n    }\n  }\n\n  /*\n   *  Creates a new mapper layer.\n   *  @interaction:   predefined interaction | callbackFn(a, b);\n   */\n  addInteractionMap(id, size, interactionFn) {\n    this.mapper.addLayer(id, size, interactionFn);\n  }\n\n  /*\n   *  Force interaction loop\n   */\n  runInteractions() {\n    let totalInteractions = this.mapper.layers.length;\n    for (let i=0; i<totalInteractions; i++) {\n      this.mapper.layers[i].iterate();\n    }\n  }\n\n  /*\n   *  Draw loop\n   */\n  draw() {\n    // Draw mapper regions (debugging)\n    if (this.DEBUG_MODE) {\n      this.debugDrawRegions(true);\n    }\n\n    // Draw particles\n    let totalParticles = this.particles.length;\n    for (let i=0; i<totalParticles; i++) {\n      this.particles[i].draw(this.ctx);\n    }\n  }\n\n  /*\n   *  Add particles to the system - if total length is > 150000 or so, check:\n   */\n  addParticles(settings) {\n    for (let i=0; i<settings.length; i++) {\n      let particle = new Particle(settings[i]);\n      particle.id = Utils.uniqueID();\n      this.particles.push(particle);\n    }\n  }\n\n}\n","export default {\n  neutral: {\n    density: 1,\n    color: \"rgba(200,200,200,0.6)\",\n    restitution: 1\n  },\n  iron: {\n    density: 1.7874,\n    color: \"#434b9d\",\n    restitution: 0.85\n  },\n  sand: {\n    density: 1.1553,\n    color: \"rgba(194, 178, 128, 0.8)\",\n    restitution: 0.31\n  },\n  water: {\n    density: 0.9997,\n    color: \"rgba(64, 164, 223, 0.6)\",\n    restitution: 0.13\n  },\n  air: {\n    density: 0.1257,\n    color: \"rgba(115, 216, 237, 0.3)\",\n    restitution: 0.3\n  }\n}\n","/*\n *  Feature Toggling\n *\n *  Activete/Hide features that are in process of development or under testing\n *  Once a feature is accepted to be includded must be removed from the\n *  feature toggle scheme\n */\n\n const FEATURE_TOGGLE = {\n   FPS_CONTROL: true                // FPS controll for AnimationPlayer class\n };\n\n export default FEATURE_TOGGLE;\n","import FEATURE_TOGGLE from '../../src/feature-toggle';\n\nexport default class AnimationPlayer {\n\n  constructor(settings) {\n    settings = settings || {};\n\n    this.window = settings.windowElement || window;\n    this.requestId = null;\n    this.playing = false;\n\n    // FPS control\n    this.fps = settings.fps || 90;\n    this.now;\n    this.lastTime = Date.now();\n    this.interval = 1000/this.fps;\n    this.delta;\n\n    this.registerEvents();\n  }\n\n  registerEvents() {\n    // Animation control: KeyDown\n    document.body.addEventListener(\"keydown\", (e) => {\n      //console.log(\"Key pressed: \", e.keyCode);\n      switch (e.keyCode) {\n        case 27:                        // Esc\n        if (this.playing) {\n          this.stop();\n          console.log(\"> Scene stopped\");\n        } else {\n          this.play();\n          console.log(\"> Playing scene\");\n        }\n        break;\n\n        case 13:\n        this.stop();\n        this.play();\n        this.stop();\n        console.log(\"> Step forward\");\n        break;\n\n        default:\n        break;\n      }\n    });\n  }\n\n  play() {\n    this.playing = true;\n    this.updateFn();\n  }\n\n  stop() {\n    if (!this.playing) {\n      return false;\n    }\n    this.window.cancelAnimationFrame(this.requestId);\n    this.playing = false;\n    this.requestId = null;\n  }\n\n  setUpdateFn(updateFn) {\n    this.updateFn = (\n      () => {\n        this.requestId = this.window.requestAnimationFrame(this.updateFn);\n        this.now = Date.now();\n        this.delta = this.now - this.lastTime;\n\n        if (this.delta > this.interval) {\n          this.lastTime = this.now - (this.delta % this.interval);\n          updateFn(this.delta, this.lastTime);\n        }\n        return;\n\n\n        updateFn();\n\n      });\n    }\n\n    updateFn() {\n      console.warn(\"Player update function has not been set.\");\n    }\n  }\n","import FEATURE_TOGGLE from '../../src/feature-toggle';\n\nexport default class Particle {\n\n  /*\n   *   Pass 'boxBounce' as { w: <with>, h: <height> } to make particle bounce inside a box\n   *\n   **/\n    constructor(settings) {\n        this.x = settings.x || 0;\n        this.y = settings.y || 0;\n        this.vx = (Math.cos(settings.direction) * settings.speed) || 0;\n        this.vy = (Math.sin(settings.direction) * settings.speed) || 0;\n        this.gravity = settings.gravity || 0;\n        this.mass = settings.mass || 1;\n        this.radius = settings.radius || settings.mass * 0.87;\n        this.friction = settings.friction || 1;\n        this.springs = [];\n        this.gravitations = [];\n        this.positionUpdated = false;\n        this.color = settings.color || 'rgba(0,0,0,0.6)';\n        this.boxBounce = settings.boxBounce || false;\n    }\n\n    /*\n     *  Updates the state of the particle\n     */\n    update() {\n        let x = this.x;\n        let y = this.y;\n\n        this.handleSprings();\n        this.handleGravitations();\n        this.vy += this.gravity;\n        this.vx *= this.friction;\n        this.vy *= this.friction;\n        this.x += this.vx;\n        this.y += this.vy;\n\n        if (this.boxBounce) {\n          this.checkBorders(this.boxBounce.w, this.boxBounce.h);\n        }\n\n        if (x !== this.x && y !== this.y) {\n          this.positionUpdated = true;\n        } else {\n\n        }\n    }\n\n    /*\n     *  Gets the length of the velocity vector, which equals to the hypotenuse\n     */\n    getSpeed() {\n        return Math.sqrt(this.vx * this.vx + this.vy * this.vy);\n    }\n\n    /*\n     *  Using the actual Velocity vector's angle, sets a new length for it\n     */\n    setSpeed(speed) {\n        let heading = this.getHeading();\n        this.vx = Math.cos(heading) * speed;\n        this.vy = Math.sin(heading) * speed;\n    }\n\n    /*\n     *  Gets the angle direction of the velocity vector\n     */\n    getHeading() {\n        return Math.atan2(this.vy, this.vx);\n    }\n\n    /*\n     *  Changes the Velocity vector's angle and recalculate coordinates\n     */\n    setHeading(heading) {\n        let speed = this.getSpeed();\n        this.vx = Math.cos(heading) * speed;\n        this.vy = Math.sin(heading) * speed;\n    }\n\n    /*\n     *  Sums to the Velocity vector x and y values\n     */\n    accelerate(x, y) {\n        this.vx += x;\n        this.vy += y;\n    }\n\n    /*\n    *  Bounce if the particle hits the box (i.e. screen) borders\n    */\n    checkBorders(width, height) {\n      if (this.x + this.radius >= width) {\n        this.x = width - this.radius;\n        this.vx *=  -1;\n      } else if (this.x - this.radius <= 0) {\n        this.x = this.radius;\n        this.vx *= -1;\n      }\n\n      if (this.y + this.radius >= height) {\n        this.y = height - this.radius;\n        this.vy *=  -1;\n      } else if (this.y - this.radius <= 0) {\n        this.y = this.radius;\n        this.vy *= -1;\n      }\n    }\n\n    /*\n     *  Calculates the angle between this particle and 'p2'\n     */\n    angleTo(p2) {\n        return Math.atan2(p2.y - this.y, p2.x - this.x);\n    }\n\n    /*\n     *  Calculates the distance to a given particle\n     */\n    distanceTo(p) {\n        let dx = p.x - this.x;\n        let dy = p.y - this.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    /*\n     *  Calculates and applies a gravitation vector to a given particle\n     */\n     gravitateTo(p, gravityFactor) {\n         gravityFactor = gravityFactor || 0.04;\n\n         let radiusSum = this.radius + p.radius;\n         let massFactor = this.mass * p.mass;\n\n         let dx = p.x - this.x;\n         let dy = p.y - this.y;\n         let distSQ = (dx * dx) + (dy * dy);\n         let dist = Math.sqrt(distSQ);\n         let surfaceDist = dist - radiusSum;\n\n         // Cancel gravitation once objects collide\n         // TODO: Verify if we can save the Math.sqrt() comparing squares\n         if (dist < radiusSum + 5) {\n           return;\n         }\n\n         //let force = (p.mass) / distSQ; // Force = mass / square of the distance\n         let force = gravityFactor * massFactor / (surfaceDist * surfaceDist);\n\n         let ax = (dx / surfaceDist) * force;\n         let ay = (dy / surfaceDist) * force;\n\n         this.vx += ax;\n         this.vy += ay;\n     }\n\n    /*\n     *  Registers a particle to gravitate to\n     */\n    addGravitation(p) {\n        this.removeGravitation(p);\n        this.gravitations.push(p);\n    }\n\n    /*\n     *  Unregisters a gravitation particle\n     */\n    removeGravitation(p) {\n        let length = this.gravitations.length;\n        for (let i=0; i<length; i++){\n            if (this.gravitations[i] === p) {\n                this.gravitations.slice(i, 1);\n                return true;\n            }\n        }\n    }\n\n    /*\n     *  Gravitates to each registered gravitation particle\n     */\n    handleGravitations() {\n        let length = this.gravitations.length;\n        for (let i=0; i<length; i++){\n            this.gravitateTo(this.gravitations[i]);\n        }\n    }\n\n    /*\n     *  Calculates and applies a spring vector to a given point\n     */\n    springTo(point, k, length) {\n        let dx = point.x - this.x;\n        let dy = point.y - this.y;\n        let distance = Math.sqrt(dx * dx + dy * dy);\n        let force = (distance - length || 0) * k;\n        // Instead of getting cos / sin of angle, divide sides by hypotenuse\n        this.vx += (dx / distance) * force;\n        this.vy += (dy / distance) * force;\n    }\n\n    /*\n     *  Registers a new spring point\n     */\n    addSpring(point, k, length) {\n        this.removeSpring(point);\n        this.springs.push({\n            point: point,\n            k: k,\n            length: length || 0\n        });\n    }\n\n    /*\n     *  Unregisters a spring point\n     */\n    removeSpring(point) {\n        let length = this.springs.length;\n        for (let i=0; i<length; i++){\n            if (this.springs[i].point === point) {\n                this.springs.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n\n    /*\n     *  Springs to each registered spring point\n     */\n    handleSprings() {\n        let length = this.springs.length;\n        for (let i=0; i<length; i++){\n            let spring = this.springs[i];\n            this.springTo(spring.point, spring.k, spring.length);\n        }\n    }\n}\n","import FEATURE_TOGGLE from '../../src/feature-toggle';\n\nclass Utils {\n\n  constructor() {\n    this.cache = {};\n  }\n\n  cacheStore(caller, key, value) {\n    if (!this.cache.hasOwnProperty(caller)) {\n      this.cache[caller] = {};\n    }\n    this.cache[caller][key] = value;\n  }\n\n  cacheRetrieve(caller, key) {\n    let fnCache = this.cache[caller] || [];\n    let value = fnCache[key] || false;\n    return value;\n  }\n\n  /*\n   *  Get 'n' points from a circular shaped 'Particle' object\n   */\n  getCirclePoints(p, n, radius) {\n    n = n || 8;\n    radius = radius || p.radius || 0;\n\n    let angle = -1;\n    let angleStep = (Math.PI * 2) / n;\n    let points = [];\n\n    for (let i=0; i<n; i++) {\n      let cData = this.cacheRetrieve(\"getCirclePoints\", angle);\n      let cos = cData.cos || Math.cos(angle);\n      let sin = cData.sin || Math.sin(angle);\n      let pt = {\n        x: p.x + (cos * p.radius),\n        y: p.y + (sin * p.radius)\n      };\n      points.push(pt);\n      if (!cData) {\n        this.cacheStore(\"getCirclePoints\", angle, {cos: cos, sin: sin});\n      }\n      angle += angleStep;\n    }\n\n    // Add the center point\n    return points;\n  }\n\n  montecarlo() {\n    while(true) {\n      let r1 = Math.random();\n      let p = r1;\n      let r2 = Math.random();\n      if (r2 < p) {\n        return r1;\n      }\n    }\n  }\n\n  lerp(norm, min, max) {\n    return (max - min) * norm + min;\n  }\n\n  quadraticBezier(p0, p1, p2, t, pFinal) {\n    pFinal = pFinal || {};\n    pFinal.x = Math.pow(1 - t, 2) * p0.x + (1 - t) * 2 * t * p1.x + t * t * p2.x;\n    pFinal.y = Math.pow(1 - t, 2) * p0.y + (1 - t) * 2 * t * p1.y + t * t * p2.y;\n    return pFinal;\n  }\n\n  cubicBezier(p0, p1, p2, p3, t, pFinal) {\n    pFinal = pFinal || {};\n    pFinal.x = Math.pow(1 - t, 3) * p0.x + Math.pow(1 - t, 2) * 3 * t * p1.x + (1 - t) * 3 * t * t * p2.x + t * t * t * p3.x;\n    pFinal.y = Math.pow(1 - t, 3) * p0.y + Math.pow(1 - t, 2) * 3 * t * p1.y + (1 - t) * 3 * t * t * p2.y + t * t * t * p3.y;\n    return pFinal;\n  }\n\n  distance(p0, p1) {\n    let dx = p0.x - p1.x;\n    let dy = p0.y - p1.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  distanceXY(x0, y0, x1, y1) {\n    let dx = x1 - x0;\n    let dy = y1 - y0;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  // TODO: Check if and why we need to parseInt() the result\n  mapRange(value, low1, high1, low2, high2) {\n    return result = low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n    let result = low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n    if (low2 === parseInt(low2, 10) || high2 === parseInt(high2, 10)) {\n      result = parseInt(result);\n    }\n    return result;\n  }\n\n  inRange(value, min, max) {\n    return value >= Math.min(min, max) && value <= Math.max(min, max);\n  }\n\n  rangeIntersect(min0, max0, min1, max1) {\n    return  Math.max(min0, max0) >= Math.min(min1, max1) &&\n    Math.min(min0, max0) <= Math.max(min1, max1);\n  }\n\n  randomRange(min, max) {\n    return min + Math.random() * (max - min);\n  }\n\n  constrain(e,t,r) {\n    return e>r?r:e<t?t:e;\n  }\n\n  circleCollision(c0, c1) {\n    return this.distance(c0, c1) <= c0.radius + c1.radius;\n  }\n\n  rectangleCollision(r0, r1) {\n    return  this.rangeIntersect(r0.x, r0.x + r0.width, r1.x, r1.x + r1.width) &&\n    this.rangeIntersect(r0.y, r0.y + r0.height, r1.y, r1.y + r1.height);\n  }\n\n  circlePointCollision(px, py, circle) {\n    return this.distanceXY(px, py, circle.x, circle.y) < circle.radius;\n  }\n\n  rectanglePointCollision(px, py, rect) {\n    return  this.inRange(px, rect.x, rect.x + rect.width) &&\n    this.inRange(py, rect.y, rect.y + rect.height);\n  }\n\n  uniqueID() {\n    function s4() {\n      return Math.floor((1 + Math.random()) * 0x10000)\n        .toString(16)\n        .substring(1);\n    }\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n      s4() + '-' + s4() + s4() + s4();\n  }\n\n  randomColor() {\n    return \"#000000\".replace(/0/g,function(){return (~~(Math.random()*16)).toString(16);});\n  }\n}\n\nlet instance = new Utils();\n\nexport default instance;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwcm9qZWN0cy9jb2xsaXNpb25lci9hcHAuanMiLCJwcm9qZWN0cy9jb2xsaXNpb25lci9pbnRlcmFjdGlvbnMuanMiLCJwcm9qZWN0cy9jb2xsaXNpb25lci9saWIvTWFwcGVyLmpzIiwicHJvamVjdHMvY29sbGlzaW9uZXIvbGliL01hcHBlckxheWVyLmpzIiwicHJvamVjdHMvY29sbGlzaW9uZXIvbGliL01hcHBlclJlZ2lvbi5qcyIsInByb2plY3RzL2NvbGxpc2lvbmVyL2xpYi9QYXJ0aWNsZUV4dC5qcyIsInByb2plY3RzL2NvbGxpc2lvbmVyL2xpYi9QYXJ0aWNsZU1hbmFnZXIuanMiLCJwcm9qZWN0cy9jb2xsaXNpb25lci9tYXR0ZXIuanMiLCJzcmMvZmVhdHVyZS10b2dnbGUuanMiLCJzcmMvbGliL0FuaW1hdGlvblBsYXllci5qcyIsInNyYy9saWIvUGFydGljbGUuanMiLCJzcmMvbGliL1V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUEsT0FBTyxNQUFQLEdBQWdCLFlBQU07O0FBRXBCLE1BQU0sU0FBUyxTQUFTLGNBQVQsQ0FBd0IsUUFBeEIsQ0FBZjtBQUNBLE1BQU0sTUFBTSxPQUFPLFVBQVAsQ0FBa0IsSUFBbEIsQ0FBWjtBQUNBLE1BQU0sUUFBUSxPQUFPLFVBQXJCO0FBQ0EsTUFBTSxTQUFTLE9BQU8sV0FBUCxHQUFtQixDQUFsQztBQUNBLE1BQU0sU0FBUyxFQUFFLEdBQUcsUUFBTSxDQUFYLEVBQWMsR0FBRyxTQUFPLENBQXhCLEVBQWY7O0FBRUEsU0FBTyxNQUFQLEdBQWdCLE1BQWhCO0FBQ0EsU0FBTyxLQUFQLEdBQWUsS0FBZjs7QUFHQTtBQUNBLE1BQU0sSUFBSSxHQUFWO0FBQ0EsTUFBSSxRQUFRO0FBQ1YsT0FBRztBQURPLEdBQVo7O0FBS0EsTUFBSSxTQUFT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O0FBQ0Q7Ozs0Q0FFdUIsRSxFQUFJLEUsRUFBSSxJLEVBQU07QUFDcEMsYUFBUSxLQUFLLE9BQUwsQ0FBYSxFQUFiLEVBQWlCLEtBQUssQ0FBdEIsRUFBeUIsS0FBSyxDQUFMLEdBQVMsS0FBSyxLQUF2QyxLQUNSLEtBQUssT0FBTCxDQUFhLEVBQWIsRUFBaUIsS0FBSyxDQUF0QixFQUF5QixLQUFLLENBQUwsR0FBUyxLQUFLLE1BQXZDLENBREE7QUFFRDs7OytCQUVVO0FBQ1QsZUFBUyxFQUFULEdBQWM7QUFDWixlQUFPLEtBQUssS0FBTCxDQUFXLENBQUMsSUFBSSxLQUFLLE1BQUwsRUFBTCxJQUFzQixPQUFqQyxFQUNKLFFBREksQ0FDSyxFQURMLEVBRUosU0FGSSxDQUVNLENBRk4sQ0FBUDtBQUdEO0FBQ0QsYUFBTyxPQUFPLElBQVAsR0FBYyxHQUFkLEdBQW9CLElBQXBCLEdBQTJCLEdBQTNCLEdBQWlDLElBQWpDLEdBQXdDLEdBQXhDLEdBQ0wsSUFESyxHQUNFLEdBREYsR0FDUSxJQURSLEdBQ2UsSUFEZixHQUNzQixJQUQ3QjtBQUVEOzs7a0NBRWE7QUFDWixhQUFPLFVBQVUsT0FBVixDQUFrQixJQUFsQixFQUF1QixZQUFVO0FBQUMsZUFBTyxDQUFDLENBQUMsRUFBRSxLQUFLLE1BQUwsS0FBYyxFQUFoQixDQUFGLEVBQXVCLFFBQXZCLENBQWdDLEVBQWhDLENBQVA7QUFBNEMsT0FBOUUsQ0FBUDtBQUNEOzs7Ozs7QUFHSCxJQUFJLFdBQVcsSUFBSSxLQUFKLEVBQWY7O2tCQUVlLFEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IFV0aWxzIGZyb20gJy4uLy4uL3NyYy9saWIvVXRpbHMnO1xuaW1wb3J0IEFuaW1hdGlvblBsYXllciBmcm9tICcuLi8uLi9zcmMvbGliL0FuaW1hdGlvblBsYXllcic7XG5pbXBvcnQgUGFydGljbGVNYW5hZ2VyIGZyb20gJy4vbGliL1BhcnRpY2xlTWFuYWdlcic7XG5pbXBvcnQgTWF0dGVyIGZyb20gJy4vbWF0dGVyJztcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcblxuICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKTtcbiAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgY29uc3Qgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgY29uc3QgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0LTQ7XG4gIGNvbnN0IGNlbnRlciA9IHsgeDogd2lkdGgvMiwgeTogaGVpZ2h0LzIgfTtcblxuICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICBjYW52YXMud2lkdGggPSB3aWR0aDtcblxuXG4gIC8vIFdvcmxkIHNldHRpbmdzXG4gIGNvbnN0IEcgPSA5Ljg7XG4gIGxldCB3b3JsZCA9IHtcbiAgICBHOiBHXG4gIH07XG5cblxuICBsZXQgcGxheWVyID0gbmV3IEFuaW1hdGlvblBsYXllcih7IGZwczogNjAgfSk7XG5cblxuICAvLyBDcmVhdGUgcGFydGljbGUgZml4dHVyZXNcbiAgbGV0IHBhcnRpY2xlc0ZpeHR1cmVzID0gbmV3IEFycmF5KDkwMCk7XG4gIGxldCBtYXR0ZXJUeXBlcyA9IE9iamVjdC5rZXlzKE1hdHRlcilcbiAgbGV0IG5ldXRyYWxUeXBlSW5kZXggPSBtYXR0ZXJUeXBlcy5pbmRleE9mKCduZXV0cmFsJyk7XG4gIG1hdHRlclR5cGVzLnNwbGljZShuZXV0cmFsVHlwZUluZGV4LCAxKTtcbiAgbGV0IHRvdGFsTWF0dGVyVHlwZXMgPSBtYXR0ZXJUeXBlcy5sZW5ndGg7XG5cbiAgZm9yIChsZXQgaT0wOyBpPHBhcnRpY2xlc0ZpeHR1cmVzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICBsZXQgcmFuZG9tTWF0dGVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdG90YWxNYXR0ZXJUeXBlcykgKyAwO1xuICAgIGxldCBtYXR0ZXJUeXBlID0gbWF0dGVyVHlwZXNbcmFuZG9tTWF0dGVyXTtcblxuICAgIGxldCBwID0ge1xuICAgICAgICB4OiBVdGlscy5yYW5kb21SYW5nZSg1MCwgd2lkdGgtNTApLFxuICAgICAgICB5OiBVdGlscy5yYW5kb21SYW5nZSg1MCwgaGVpZ2h0LTUwKSxcbiAgICAgICAgbWFzczogVXRpbHMucmFuZG9tUmFuZ2UoMywgNSksXG4gICAgICAgIGRpcmVjdGlvbjogVXRpbHMucmFuZG9tUmFuZ2UoLTEsIDEpLFxuICAgICAgICAvL3NwZWVkOiBVdGlscy5yYW5kb21SYW5nZSgyLCA1KSxcbiAgICAgICAgbWF0dGVyOiBtYXR0ZXJUeXBlLFxuICAgICAgICBib3hCb3VuY2U6IHsgdzogd2lkdGgsIGg6IGhlaWdodCB9XG4gICAgfTtcblxuICAgIHBhcnRpY2xlc0ZpeHR1cmVzW2ldID0gcDtcbiAgfVxuXG4gIC8vIHBhcnRpY2xlc0ZpeHR1cmVzWzBdID0ge1xuICAvLyAgIHg6IGNlbnRlci54LTQwLFxuICAvLyAgIHk6IGNlbnRlci55LFxuICAvLyAgIG1hc3M6IDE0OCxcbiAgLy8gICBtYXR0ZXI6IFwiaXJvblwiLFxuICAvLyAgIGRpcmVjdGlvbjogTWF0aC5QSSoyLFxuICAvLyAgIC8vc3BlZWQ6IDAuOSxcbiAgLy8gICBib3hCb3VuY2U6IHsgdzogd2lkdGgsIGg6IGhlaWdodCB9XG4gIC8vIH07XG4gIC8vXG4gIC8vIHBhcnRpY2xlc0ZpeHR1cmVzWzFdID0ge1xuICAvLyAgIHg6IGNlbnRlci54KzEwMCxcbiAgLy8gICB5OiBjZW50ZXIueSxcbiAgLy8gICBtYXNzOiAzLFxuICAvLyAgIG1hdHRlcjogXCJhaXJcIixcbiAgLy8gICBkaXJlY3Rpb246IE1hdGguUEksXG4gIC8vICAgLy9zcGVlZDogMS4zLFxuICAvLyAgIGJveEJvdW5jZTogeyB3OiB3aWR0aCwgaDogaGVpZ2h0IH1cbiAgLy8gfTtcblxuICBsZXQgcG1hbmFnZXIgPSBuZXcgUGFydGljbGVNYW5hZ2VyKHtcbiAgICBkZWJ1ZzogZmFsc2VcbiAgfSwgd29ybGQsIGN0eCk7XG5cbiAgLy8gQ3JlYXRlIGludGVyYWN0aW9uIG1hcHNcbiAgLy8gVE9ETzogQ2hlY2sgd2hhdCBoYXBwZW5zIHdpdGggZHVwbGljYXRlZCBsYXllcnMuXG4gIGxldCBjb2xsaXNpb25SZWdpb25TaXplID0gMjAwO1xuICBsZXQgZ3Jhdml0eVJlZ2lvblNpemUgPSB3aWR0aDtcbiAgcG1hbmFnZXIuYWRkSW50ZXJhY3Rpb25NYXAoJ2NvbGxpc2lvbicsIGNvbGxpc2lvblJlZ2lvblNpemUsICdjb2xsaXNpb24nKTtcbiAgcG1hbmFnZXIuYWRkSW50ZXJhY3Rpb25NYXAoJ2dyYXZpdHknLCBncmF2aXR5UmVnaW9uU2l6ZSwgJ2dyYXZpdHknKTtcblxuICAvLyBBZGQgcGFydGljbGVzRml4dHVyZXMgaW50byB0aGUgTWFwcGVyXG4gIHBtYW5hZ2VyLmFkZFBhcnRpY2xlcyhwYXJ0aWNsZXNGaXh0dXJlcyk7XG5cbiAgLy8gRGVtbyBwbGF5ZXIgc2V0dXBcbiAgcGxheWVyLnNldFVwZGF0ZUZuKHVwZGF0ZSk7XG4gIC8vcGxheWVyLnBsYXkoKTtcblxuXG4gIC8vIEZyYW1lIGRyYXdpbmcgZnVuY3Rpb25cbiAgZnVuY3Rpb24gdXBkYXRlKCkge1xuXG4gICAgLy8gVXBkYXRlIHBhcnRpY2xlJ3Mgc3RhdGVcbiAgICBwbWFuYWdlci51cGRhdGUoKTtcblxuICAgIC8vIENsZWFyIGZ1bGwgc2NyZWVuXG4gICAgY3R4LmNsZWFyUmVjdCgwLDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgLy8gR2xvYmFsIGRyYXdcbiAgICBwbWFuYWdlci5kcmF3KCk7XG4gIH1cblxufTtcbiIsImV4cG9ydCBkZWZhdWx0IHtcbiAgJ2dyYXZpdHknOiAoYSwgYikgPT4ge1xuICAgIGEuZ3Jhdml0YXRlVG8oYik7XG4gIH0sXG4gICdjb2xsaXNpb24nOiAoYSwgYikgPT4ge1xuICAgIGxldCBjb2xsaXNpb24gPSBhLmNvbGxpc2lvbkNoZWNrKGIpO1xuICAgIGlmIChjb2xsaXNpb24pIHtcbiAgICAgIGEuY29sbGlzaW9uSGFuZGxlKGIsIGNvbGxpc2lvbik7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgSW50ZXJhY3Rpb25zIGZyb20gJy4uL2ludGVyYWN0aW9ucyc7XG5pbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vc3JjL2xpYi9VdGlscyc7XG5pbXBvcnQgTGF5ZXIgZnJvbSAnLi9NYXBwZXJMYXllcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcHBlciB7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5sYXllcnMgPSBbXTtcbiAgICB0aGlzLmxheWVySW5kZXggPSB7fTtcbiAgfVxuXG4gIC8qXG4gICAqICBDcmVhdGVzIGEgbmV3IExheWVyIGluIHRoZSBNYXBwZXJcbiAgICovXG4gIGFkZExheWVyKGlkLCByZWdpb25TaXplLCBpbnRlcmFjdGlvbkZuKSB7XG5cbiAgICBpZiAodHlwZW9mIGludGVyYWN0aW9uRm4gPT09ICdzdHJpbmcnICYmIEludGVyYWN0aW9ucy5oYXNPd25Qcm9wZXJ0eShpbnRlcmFjdGlvbkZuKSkge1xuICAgICAgaW50ZXJhY3Rpb25GbiA9IEludGVyYWN0aW9uc1tpbnRlcmFjdGlvbkZuXTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKCdNYXBwZXIuYWRkTGF5ZXI6ICcrIGludGVyYWN0aW9uRm4gKycgaXMgbm90IGEgcHJlZGVmaW5lZCBJbnRlcmFjdGlvbicpO1xuICAgIH1cblxuICAgIGxldCBsYXllciA9IG5ldyBMYXllcih7XG4gICAgICBpZDogaWQsXG4gICAgICByZWdpb25TaXplOiByZWdpb25TaXplLFxuICAgICAgaW50ZXJhY3Rpb25GbjogaW50ZXJhY3Rpb25GblxuICAgIH0pO1xuXG4gICAgdGhpcy5sYXllcnMucHVzaChsYXllcik7XG4gICAgdGhpcy5sYXllckluZGV4W2lkXSA9IGxheWVyO1xuXG4gICAgcmV0dXJuIHRoaXMubGF5ZXJJbmRleFtpZF07XG4gIH1cblxuICAvKlxuICAgKiAgUmVnaXN0ZXJzIGEgcGFydGljbGUgaW4gYWxsIHRoZSBxdWFsaWZpZWQgcmVnaW9ucyBvZiBlYWNoIE1hcHBlciBMYXllclxuICAgKi9cbiAgcmVnaXN0ZXIocCkge1xuICAgIGxldCBtYXBwZXJEYXRhID0gW107XG4gICAgbGV0IHRvdGFsTGF5ZXJzID0gdGhpcy5sYXllcnMubGVuZ3RoO1xuICAgIGxldCBwb2ludHMgPSBVdGlscy5nZXRDaXJjbGVQb2ludHMocCk7XG4gICAgbGV0IHRvdGFsUG9pbnRzID0gcG9pbnRzLmxlbmd0aDtcblxuICAgIGZvciAobGV0IHg9MDsgeDx0b3RhbExheWVyczsgeCsrKSB7XG4gICAgICBsZXQgbGF5ZXIgPSB0aGlzLmxheWVyc1t4XTtcbiAgICAgIGxldCBxdWFsaWZpZWRSZWdpb25zID0gW107XG5cbiAgICAgIHRoaXMudW5yZWdpc3RlcihwKTtcblxuICAgICAgZm9yIChsZXQgaT0wOyBpPHRvdGFsUG9pbnRzOyBpKyspIHtcbiAgICAgICAgbGV0IHJlZ2lvbkRhdGEgPSB0aGlzLnF1YWxpZnlQb2ludChwb2ludHNbaV0sIGxheWVyLmlkKTtcbiAgICAgICAgbGV0IHRvdGFsUXVhbGlmaWVkID0gcXVhbGlmaWVkUmVnaW9ucy5sZW5ndGg7XG4gICAgICAgIGxldCBleGlzdHMgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGxldCB6PTA7IHo8dG90YWxRdWFsaWZpZWQ7IHorKykge1xuICAgICAgICAgIGlmIChxdWFsaWZpZWRSZWdpb25zW3pdLmlkID09PSByZWdpb25EYXRhLmlkKSB7XG4gICAgICAgICAgICBleGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICBpZiAoIWxheWVyLnJlZ2lvbkluZGV4Lmhhc093blByb3BlcnR5KHJlZ2lvbkRhdGEuaWQpKSB7XG4gICAgICAgICAgICBsYXllci5hZGRSZWdpb24ocmVnaW9uRGF0YSlcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsZXQgcmVnaW9uID0gbGF5ZXIucmVnaW9uSW5kZXhbcmVnaW9uRGF0YS5pZF07XG4gICAgICAgICAgcmVnaW9uLnN1YnNjcmliZShwKTtcbiAgICAgICAgICBxdWFsaWZpZWRSZWdpb25zLnB1c2gocmVnaW9uKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtYXBwZXJEYXRhLnB1c2goe1xuICAgICAgICBpZDogbGF5ZXIuaWQsXG4gICAgICAgIHJlZ2lvbnM6IHF1YWxpZmllZFJlZ2lvbnNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHAubWFwcGVyRGF0YSA9IG1hcHBlckRhdGE7XG4gIH1cblxuICAvKlxuICAgKiAgVW5zdWJzY3JpYmUgcGFydGljbGUgZnJvbSBldmVyeSBMYXllci9SZWdpb24gYW5kIHJlc2V0IHBhcnRpY2xlJ3MgbWFwcGVyIGRhdGFcbiAgICovXG4gIHVucmVnaXN0ZXIocCkge1xuICAgIGxldCB0b3RhbExheWVycyA9IHAubWFwcGVyRGF0YS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaT0wOyBpPHRvdGFsTGF5ZXJzOyBpKyspIHtcbiAgICAgIGxldCBsYXllcklEID0gcC5tYXBwZXJEYXRhW2ldLmlkO1xuICAgICAgbGV0IHRvdGFsUmVnaW9ucyA9IHAubWFwcGVyRGF0YVtpXS5yZWdpb25zLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IHI9MDsgcjx0b3RhbFJlZ2lvbnM7IHIrKykge1xuICAgICAgICBwLm1hcHBlckRhdGFbaV0ucmVnaW9uc1tyXS51bnN1YnNjcmliZShwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnJlc2V0KHApO1xuICB9XG5cbiAgLypcbiAgICogIERlbGV0ZXMgYWxsIG1hcGVwciBkYXRhIGZyb20gUGFydGljbGVcbiAgICovXG4gIHJlc2V0KHApIHtcbiAgICBwLm1hcHBlckRhdGEgPSBbXTtcbiAgfVxuXG4gIC8qXG4gICAqICBRdWFsaWZpZXMgYSBzaW5nbGUgcG9pbnQgaW50byBhIExheWVyIFJlZ2lvblxuICAgKi9cbiAgcXVhbGlmeVBvaW50KHB0LCBsYXllcklkKSB7XG4gICAgbGV0IHJlZ2lvblNpemUgPSB0aGlzLmxheWVySW5kZXhbbGF5ZXJJZF0ucmVnaW9uU2l6ZTtcbiAgICBsZXQgeENvbXBvbmVudCA9IHB0LnggPiByZWdpb25TaXplID8gTWF0aC5mbG9vcihNYXRoLmFicyhwdC54IC8gcmVnaW9uU2l6ZSkpOjA7XG4gICAgbGV0IHlDb21wb25lbnQgPSBwdC55ID4gcmVnaW9uU2l6ZSA/IE1hdGguZmxvb3IoTWF0aC5hYnMocHQueSAvIHJlZ2lvblNpemUpKTowO1xuICAgIGxldCBkYXRhID0ge1xuICAgICAgaWQ6IG51bGwsXG4gICAgICB4OiB4Q29tcG9uZW50ICogcmVnaW9uU2l6ZSxcbiAgICAgIHk6IHlDb21wb25lbnQgKiByZWdpb25TaXplXG4gICAgfTtcbiAgICBkYXRhLmlkID0geENvbXBvbmVudCArIFwiX1wiKyB5Q29tcG9uZW50O1xuICAgIHJldHVybiBkYXRhO1xuICB9XG59XG4iLCJpbXBvcnQgUmVnaW9uIGZyb20gJy4vTWFwcGVyUmVnaW9uJztcbmltcG9ydCBVdGlscyBmcm9tICcuLi8uLi8uLi9zcmMvbGliL1V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFwcGVyTGF5ZXIge1xuXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzKSB7XG4gICAgdGhpcy5pZCA9IHNldHRpbmdzLmlkO1xuICAgIHRoaXMucmVnaW9uU2l6ZSA9IHNldHRpbmdzLnJlZ2lvblNpemU7XG4gICAgdGhpcy5yZWdpb25zID0gW107XG4gICAgdGhpcy5yZWdpb25JbmRleCA9IHt9O1xuICAgIHRoaXMuaW50ZXJhY3Rpb24gPSBzZXR0aW5ncy5pbnRlcmFjdGlvbkZuO1xuICAgIHRoaXMuY29sb3IgPSBVdGlscy5yYW5kb21Db2xvcigpO1xuICB9XG5cbiAgLypcbiAgICogIENyZWF0ZXMgYSBuZXcgUmVnaW9uIGluIHRoZSBNYXBwZXJcbiAgICovXG4gIGFkZFJlZ2lvbihyZWdpb25EYXRhKSB7XG4gICAgbGV0IHJlZ2lvbiA9IG5ldyBSZWdpb24oe1xuICAgICAgaWQ6IHJlZ2lvbkRhdGEuaWQsXG4gICAgICB4OiByZWdpb25EYXRhLngsXG4gICAgICB5OiByZWdpb25EYXRhLnksXG4gICAgICBzaXplOiB0aGlzLnJlZ2lvblNpemUsXG4gICAgICBsYXllcjogdGhpc1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZWdpb25zLnB1c2gocmVnaW9uKTtcbiAgICB0aGlzLnJlZ2lvbkluZGV4W3JlZ2lvbkRhdGEuaWRdID0gcmVnaW9uO1xuICB9XG5cbiAgLypcbiAgICogIEl0ZXJhdGVzIGFsbCBMYXllciBSZWdpb25zIGFuZCBmaXJlcyBpdCdzIGludGVyYWN0aW9uIGZ1bmN0aW9uXG4gICAqL1xuICBpdGVyYXRlKCkge1xuICAgIGxldCB0b3RhbFJlZ2lvbnMgPSB0aGlzLnJlZ2lvbnMubGVuZ3RoO1xuICAgIGZvciAobGV0IHg9MDsgeDx0b3RhbFJlZ2lvbnM7IHgrKykge1xuICAgICAgdGhpcy5yZWdpb25zW3hdLmludGVyYWN0KCk7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNYXBwZXJSZWdpb24ge1xuXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzKSB7XG4gICAgdGhpcy5pZCA9IHNldHRpbmdzLmlkO1xuICAgIHRoaXMueCA9IHNldHRpbmdzLng7XG4gICAgdGhpcy55ID0gc2V0dGluZ3MueTtcbiAgICB0aGlzLnNpemUgPSBzZXR0aW5ncy5zaXplO1xuICAgIHRoaXMubGF5ZXIgPSBzZXR0aW5ncy5sYXllcjtcbiAgICB0aGlzLnBhcnRpY2xlcyA9IFtdO1xuICAgIHRoaXMudG90YWxQYXJ0aWNsZXMgPSAwO1xuICAgIHRoaXMucGFydGljbGVJbmRleCA9IHt9O1xuICB9XG5cbiAgLypcbiAgICogIFN1YnNjcmliZXMgYSBQYXJ0aWNsZSB0byB0aGUgUmVnaW9uXG4gICAqL1xuICBzdWJzY3JpYmUocCkge1xuICAgIHRoaXMucGFydGljbGVzLnB1c2gocC5pZCk7XG4gICAgdGhpcy5wYXJ0aWNsZUluZGV4W3AuaWRdID0gcDtcbiAgICB0aGlzLnRvdGFsUGFydGljbGVzKys7XG4gIH1cblxuICAvKlxuICAgKiAgVW5zdWJzY3JpYmVzIGEgUGFydGljbGUgZnJvbSB0aGUgUmVnaW9uXG4gICAqL1xuICB1bnN1YnNjcmliZShwKSB7XG4gICAgZGVsZXRlIHRoaXMucGFydGljbGVJbmRleFtwLmlkXTtcbiAgICBsZXQgaW5kZXggPSB0aGlzLnBhcnRpY2xlcy5pbmRleE9mKHAuaWQpO1xuICAgIHRoaXMucGFydGljbGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgdGhpcy50b3RhbFBhcnRpY2xlcy0tO1xuICB9XG5cbiAgLypcbiAgICogIEl0ZXJhdGVzIHRocm91Z2ggYWwgcGFydGljbGVzIHJ1bm5pbmcgdGhlIGludGVyYWN0aW9uIGZ1bmN0aW9uXG4gICAqL1xuICBpbnRlcmFjdCgpIHtcbiAgICBmb3IgKGxldCBpPTA7IGk8dGhpcy50b3RhbFBhcnRpY2xlczsgaSsrKSB7XG4gICAgICBsZXQgQSA9IHRoaXMucGFydGljbGVJbmRleFt0aGlzLnBhcnRpY2xlc1tpXV07XG4gICAgICBmb3IgKGxldCB5PTA7IHk8dGhpcy50b3RhbFBhcnRpY2xlczsgeSsrKSB7XG4gICAgICAgIGxldCBCID0gdGhpcy5wYXJ0aWNsZUluZGV4W3RoaXMucGFydGljbGVzW3ldXTtcbiAgICAgICAgaWYgKEEuaWQgPT09IEIuaWQpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxheWVyLmludGVyYWN0aW9uKEEsIEIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBEcmF3cyB0aGUgcmVnaW9uIG9uIHNjcmVlbiAoZGVidWdnaW5nKVxuICAgKi9cbiAgZHJhdyhjdHgpIHtcbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4LnN0cm9rZVN0eWxlID0gXCIjRkZGRkZGXCI7XG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMubGF5ZXIuY29sb3I7XG4gICAgY3R4LnJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMubGF5ZXIucmVnaW9uU2l6ZSwgdGhpcy5sYXllci5yZWdpb25TaXplKTtcbiAgICBjdHguZmlsbCgpO1xuICAgIGN0eC5zdHJva2UoKTtcbiAgICBjdHguY2xvc2VQYXRoKCk7XG4gIH1cbn1cbiIsImltcG9ydCBGRUFUVVJFX1RPR0dMRSBmcm9tICcuLi8uLi8uLi9zcmMvZmVhdHVyZS10b2dnbGUnO1xuaW1wb3J0IFBhcnRpY2xlIGZyb20gJy4uLy4uLy4uL3NyYy9saWIvUGFydGljbGUnO1xuaW1wb3J0IE1hdHRlciBmcm9tICcuLi9tYXR0ZXIuanMnO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhcnRpY2xlRXh0IGV4dGVuZHMgUGFydGljbGUge1xuXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MpIHtcbiAgICAgIHN1cGVyKHNldHRpbmdzKTtcblxuICAgICAgdGhpcy5tYXR0ZXIgPSBNYXR0ZXJbc2V0dGluZ3MubWF0dGVyXSB8fCBNYXR0ZXIubmV1dHJhbDtcbiAgICAgIHRoaXMuY29sb3IgPSB0aGlzLm1hdHRlci5jb2xvcjtcbiAgICAgIHRoaXMucmFkaXVzID0gdGhpcy5tYXNzIC8gdGhpcy5tYXR0ZXIuZGVuc2l0eTtcbiAgICAgIHRoaXMubWFwcGVyRGF0YSA9IFtdO1xuICAgICAgdGhpcy5wb2ludHMgPSBzZXR0aW5ncy5wb2ludHMgfHwgW107XG4gICAgfVxuXG4gICAgZHJhdyhjdHgpIHtcbiAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgIGN0eC5hcmModGhpcy54LCB0aGlzLnksIHRoaXMucmFkaXVzLCAwLCBNYXRoLlBJICogMiwgZmFsc2UpO1xuICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICBjdHguZmlsbCgpO1xuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIH1cblxuICAgIGRlYnVnRHJhd05leHRQb3NpdGlvbihjdHgpIHtcbiAgICAgIGxldCB4ID0gdGhpcy54O1xuICAgICAgbGV0IHkgPSB0aGlzLnk7XG4gICAgICBsZXQgdnggPSB0aGlzLnZ4O1xuICAgICAgbGV0IHZ5ID0gdGhpcy52eTtcblxuICAgICAgdnkgKz0gdGhpcy5ncmF2aXR5O1xuICAgICAgdnggKj0gdGhpcy5mcmljdGlvbjtcbiAgICAgIHZ5ICo9IHRoaXMuZnJpY3Rpb247XG5cbiAgICAgIHggKz0gdng7XG4gICAgICB5ICs9IHZ5O1xuXG4gICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICBjdHguYXJjKHgsIHksIHRoaXMucmFkaXVzLCAwLCBNYXRoLlBJICogMiwgZmFsc2UpO1xuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5jb2xvcjtcbiAgICAgIGN0eC5zdHJva2UoKTtcblxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gXCJyZ2JhKDAsMCwwLDAuNSlcIjtcbiAgICAgIGN0eC5tb3ZlVG8odGhpcy54LCB0aGlzLnkpO1xuICAgICAgY3R4LmxpbmVUbyh4LCB5KTtcbiAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBBZGRzIHRvIHRoZSB2ZWxvY2l0eSB2ZWN0b3IgZGl2aWRpbmcgYnkgdGhlIG1hc3NcbiAgICAgKi9cbiAgICBhcHBseUZvcmNlKGYpIHtcbiAgICAgIHRoaXMudnggKz0gZi54IC8gdGhpcy5tYXNzO1xuICAgICAgdGhpcy52eSArPSBmLnkgLyB0aGlzLm1hc3M7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiAgQ2FsY3VsYXRlcyBhbmQgYXBwbGllcyBhIGdyYXZpdGF0aW9uIHZlY3RvciB0byBhIGdpdmVuIHBhcnRpY2xlXG4gICAgICovXG4gICAgIGdyYXZpdGF0ZVRvKHAsIGdyYXZpdHlGYWN0b3IpIHtcbiAgICAgICAgIGdyYXZpdHlGYWN0b3IgPSBncmF2aXR5RmFjdG9yIHx8IDAuMTtcblxuICAgICAgICAgbGV0IHJhZGl1c1N1bSA9IHRoaXMucmFkaXVzICsgcC5yYWRpdXM7XG4gICAgICAgICBsZXQgbWFzc0ZhY3RvciA9IHRoaXMubWFzcyAqIHAubWFzcztcblxuICAgICAgICAgbGV0IGR4ID0gcC54IC0gdGhpcy54O1xuICAgICAgICAgbGV0IGR5ID0gcC55IC0gdGhpcy55O1xuICAgICAgICAgbGV0IGRpc3RTUSA9IChkeCAqIGR4KSArIChkeSAqIGR5KTtcbiAgICAgICAgIGxldCBkaXN0ID0gTWF0aC5zcXJ0KGRpc3RTUSk7XG4gICAgICAgICBsZXQgc3VyZmFjZURpc3QgPSBkaXN0IC0gcmFkaXVzU3VtO1xuXG4gICAgICAgICAvLyBDYW5jZWwgZ3Jhdml0YXRpb24gb25jZSBvYmplY3RzIGNvbGxpZGVcbiAgICAgICAgIC8vIFRPRE86IFZlcmlmeSBpZiB3ZSBjYW4gc2F2ZSB0aGUgTWF0aC5zcXJ0KCkgY29tcGFyaW5nIHNxdWFyZXNcbiAgICAgICAgIGlmIChkaXN0IDwgcmFkaXVzU3VtKSB7XG4gICAgICAgICAgIHJldHVybjtcbiAgICAgICAgIH1cblxuICAgICAgICAgbGV0IGZvcmNlID0gZ3Jhdml0eUZhY3RvciAqIG1hc3NGYWN0b3IgLyAoZGlzdCAqIGRpc3QpO1xuXG4gICAgICAgICBsZXQgZ3Jhdml0eVZlY3RvciA9IHtcbiAgICAgICAgICAgeDogKGR4IC8gZGlzdCkgKiBmb3JjZSxcbiAgICAgICAgICAgeTogKGR5IC8gZGlzdCkgKiBmb3JjZVxuICAgICAgICAgfTtcblxuICAgICAgICAgdGhpcy5hcHBseUZvcmNlKGdyYXZpdHlWZWN0b3IpO1xuICAgICB9XG5cbiAgICAvKlxuICAgICAgICBDaGVjayBmb3IgQ2lyY2xlLUNpcmNsZSBjb2xsaXNpb25zIGFuZCByZXR1cm4gZGV0YWlsc1xuICAgICovXG4gICAgY29sbGlzaW9uQ2hlY2socCkge1xuICAgICAgLy8gR2V0IHRoZSBEaXN0YW5jZSB2ZWN0b3IgKGRpZmZlcmVuY2UgaW4gcG9zaXRpb24pXG4gICAgICBsZXQgeERpc3QgPSB0aGlzLnggLSBwLng7XG4gICAgICBsZXQgeURpc3QgPSB0aGlzLnkgLSBwLnk7XG5cbiAgICAgIC8vIFdlJ2xsIHNhdmUgYSBNYXRoLnNxcnQoKSB0byB2ZXJpZnkgZGlzdGFuY2VzIGxpa2UgdGhpczpcbiAgICAgIGxldCBkaXN0U3F1YXJlZCA9IHhEaXN0KnhEaXN0ICsgeURpc3QqeURpc3Q7XG4gICAgICBsZXQgcmFkaXVzU3F1YXJlZCA9ICh0aGlzLnJhZGl1cyArIHAucmFkaXVzKSAqICh0aGlzLnJhZGl1cyArIHAucmFkaXVzKTtcblxuICAgICAgLy8gQ29sbGlzaW9uIGNoZWNrXG4gICAgICBpZiAoZGlzdFNxdWFyZWQgPCByYWRpdXNTcXVhcmVkKSB7XG5cbiAgICAgICAgLy8gT25jZSBjb2xsaWRlZCwgZ2V0IHRoZSBEaXNwbGFjZW1lbnQgdmVjdG9yIChkaWZmZXJlbmNlIGluIHZlbG9jaXR5KVxuICAgICAgICBsZXQgeFZlbG9jaXR5ID0gcC52eCAtIHRoaXMudng7XG4gICAgICAgIGxldCB5VmVsb2NpdHkgPSBwLnZ5IC0gdGhpcy52eTtcblxuICAgICAgICAvLyBQcm9qZWN0IHRoZSBDb2xsaXNpb24gdmVjdG9yIG92ZXIgdGhlIERpc3RhbmNlIHZlY3RvclxuICAgICAgICBsZXQgZG90UHJvZHVjdCA9IHhEaXN0KnhWZWxvY2l0eSArIHlEaXN0KnlWZWxvY2l0eTtcblxuXG4gICAgICAgIC8qXG4gICAgICAgICAqXG4gICAgICAgICAqXG4gICAgICAgICAqICBIaSwgd2VsY29tZSB0byB0aGlzIFwiRG90IFByb2R1Y3RcIiBpbXBsZW1lbnRhdGlvbiAxMDEuXG4gICAgICAgICAqXG4gICAgICAgICAqICAgIERvdCBQcm9kdWN0IHdpbGwgdGVsbCBpZiBib3RoIHBhcnRpY2xlcyBhcmEgaGVhZGluZyBvbmUgdG8gdGhlIG90aGVyLCBhbmQgaWYgdGhleSBhcmVcbiAgICAgICAgICogICAgYWN0dWFsbHkgY29sbGlkaW5nIG9yIHdpbGwgY29sbGlkZSBpbiB0aGUgZnV0dXJlLlxuICAgICAgICAgKlxuICAgICAgICAgKiAgICBUaGluayBvZiBpdCBhcyBpZiB3ZSB3aGVyZSBjYWxjdWxhdGluZyB0aGUgZGlmZmVyZW5jZSBpbiBEaXN0YW5jZSAob3IgcG9zaXRpb24pIGFuZFxuICAgICAgICAgKiAgICB0aGUgZGlmZmVyZW5jZSBpbiBTcGVlZCAobGVudGgpIG9mIGJvdGggb2JqZWN0cy4gVG8gZG8gdGhpcywgd2Ugc3Vic3RyYWN0IHZlY3RvciB2YWx1ZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqICAgIFdoZW4gdGhlIGRpZmZlcmVuY2UgaW4gYW5nbGVzIGFuZCBzcGVlZHMgYmV0d2VlbiB0aGUgdHdvIG1vdmluZyBvYmplY3RzIGFyZSBib3RoOlxuICAgICAgICAgKlxuICAgICAgICAgKiAgICBOZWdhdGl2ZTogTk8gY29sbGlzaW9uOyBtYXliZSBleGFjdCBvcG9zaXRlIGRpcmVjdGlvbiBidXQgc3RpbGwgeWV0XG4gICAgICAgICAqICAgICAgICAgICAgICB0b28gZmFyIHRvIGNvbGxpZGUgLWF0IHRoaXMgdGltZSAobWF5YmUgbmV4dCB0aWNrKVxuICAgICAgICAgKlxuICAgICAgICAgKiAgICBDZXJvOiAgICAgQ09MTElTSU9OOyBhIHBlcmZlY3QgY29sbGlzaW9uIGluIGRpcmVjdGlvbiwgYWNjZWxlcmF0aW9uIGFuZCB0aW1lXG4gICAgICAgICAqXG4gICAgICAgICAqICAgIFBvc2l0aXZlOiBDT0xMSVNJT047IGV4YWN0IGRpcmVjdGlvbjsgYW5kIHRoZSByZXN1bHRpbmcgZm9yY2UgZnJvbSB0aGUgY29sbGlzaW9uXG4gICAgICAgICAqXG4gICAgICAgICAqXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZG90UHJvZHVjdCA+IDApIHtcblxuICAgICAgICAgIC8vIFRoZSByZXN1bHRpbmcgZm9yY2UgZnJvbSB0aGUgY29sbGlzaW9uIChhbmdsZSBkaWZmZXJlbmNlICsgdmVsb2NpdHkgZGlmZmVyZW5jZSlcbiAgICAgICAgICBsZXQgY29sbGlzaW9uU2NhbGUgPSBkb3RQcm9kdWN0IC8gZGlzdFNxdWFyZWQ7XG5cbiAgICAgICAgICAvLyAvLyBDb2xsaXNpb24gVmVjdG9yOlxuICAgICAgICAgIGxldCBjb2xsaXNpb24gPSB7XG4gICAgICAgICAgICB4OiB4RGlzdCAqIGNvbGxpc2lvblNjYWxlLFxuICAgICAgICAgICAgeTogeURpc3QgKiBjb2xsaXNpb25TY2FsZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICByZXR1cm4gY29sbGlzaW9uO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAgICAyRCBFbGFzdGljIGNvbGxpc2lvbiBoYW5kbGluZ1xuICAgICovXG4gICAgY29sbGlzaW9uSGFuZGxlKHAsIGNvbGxpc2lvblZlY3Rvcikge1xuXG4gICAgICAvLyAyRC1FbGFzdGljIGNvbGxpc2lvbiBmb3JtdWxhXG4gICAgICBsZXQgY29tYmluZWRNYXNzID0gdGhpcy5tYXNzICsgcC5tYXNzO1xuICAgICAgbGV0IGNvbGxpc2lvbldlaWdodDAgPSAoMiAqIHAubWFzcyAvIGNvbWJpbmVkTWFzcykgKiBwLm1hdHRlci5yZXN0aXR1dGlvbjtcbiAgICAgIGxldCBjb2xsaXNpb25XZWlnaHQxID0gKDIgKiB0aGlzLm1hc3MgLyBjb21iaW5lZE1hc3MpICogdGhpcy5tYXR0ZXIucmVzdGl0dXRpb247XG5cbiAgICAgIC8vIEFkZHMgdGhlIGNvbXB1dGVkIGNvbGxpc2lvbiByZXN1bHRzIHRvIHRoZSB2ZWxvY2l0aWVzIG9mIHRoaXMgLyBwXG4gICAgICB0aGlzLnZ4ICs9IGNvbGxpc2lvbldlaWdodDAgKiBjb2xsaXNpb25WZWN0b3IueDtcbiAgICAgIHRoaXMudnkgKz0gY29sbGlzaW9uV2VpZ2h0MCAqIGNvbGxpc2lvblZlY3Rvci55O1xuICAgICAgcC52eCAtPSBjb2xsaXNpb25XZWlnaHQxICogY29sbGlzaW9uVmVjdG9yLng7XG4gICAgICBwLnZ5IC09IGNvbGxpc2lvbldlaWdodDEgKiBjb2xsaXNpb25WZWN0b3IueTtcbiAgICB9XG59XG4iLCJpbXBvcnQgVXRpbHMgZnJvbSAnLi4vLi4vLi4vc3JjL2xpYi9VdGlscyc7XG5pbXBvcnQgUGFydGljbGUgZnJvbSAnLi9QYXJ0aWNsZUV4dCc7XG5pbXBvcnQgTWFwcGVyIGZyb20gJy4vTWFwcGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFydGljbGVNYW5hZ2VyIHtcblxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgd29ybGQsIGN0eCkge1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgICB0aGlzLmN0eCA9IGN0eDtcbiAgICB0aGlzLm1hcHBlciA9IG5ldyBNYXBwZXIoKTtcbiAgICB0aGlzLmludGVyYWN0aW9uTWFwcyA9IFtdO1xuICAgIHRoaXMucGFydGljbGVzID0gW107XG4gICAgdGhpcy5ERUJVR19NT0RFID0gc2V0dGluZ3MuZGVidWcgfHwgZmFsc2U7XG4gIH1cblxuICAvKlxuICAgKiAgR2VuZXJhbCBNYXBwZXIgdXBkYXRlIG1ldGhvZFxuICAgKi9cbiAgdXBkYXRlKCkge1xuICAgIHRoaXMudXBkYXRlUGFydGljbGVzKCk7XG4gICAgdGhpcy5ydW5JbnRlcmFjdGlvbnMoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBEZWJ1Z2dpbmc6IGRyYXdzIGFsbCByZWdpb25zIGFuZCB0b3RhbCBwYXJ0aWNsZXMgb24gc2NyZWVuXG4gICAqL1xuICBkZWJ1Z0RyYXdSZWdpb25zKGRpc3BsYXlQYXJ0aWNsZUNvdW50KSB7XG4gICAgbGV0IHRvdGFsTGF5ZXJzID0gdGhpcy5tYXBwZXIubGF5ZXJzLmxlbmd0aDtcbiAgICBsZXQgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiQk9EWVwiKVswXTtcblxuICAgIGZvciAobGV0IGk9MDsgaTx0b3RhbExheWVyczsgaSsrKSB7XG4gICAgICBsZXQgbGF5ZXIgPSB0aGlzLm1hcHBlci5sYXllcnNbaV07XG4gICAgICBsZXQgdG90YWxSZWdpb25zID0gbGF5ZXIucmVnaW9ucy5sZW5ndGg7XG5cbiAgICAgIGZvciAobGV0IHg9MDsgeDx0b3RhbFJlZ2lvbnM7IHgrKykge1xuICAgICAgICBsZXQgcmVnaW9uID0gbGF5ZXIucmVnaW9uc1t4XTtcblxuICAgICAgICAvLyBTa2lwIGVtcHR5IHJlZ2lvbnNcbiAgICAgICAgaWYgKHJlZ2lvbi50b3RhbFBhcnRpY2xlcyA+IDApIHtcbiAgICAgICAgICByZWdpb24uZHJhdyh0aGlzLmN0eCk7XG5cbiAgICAgICAgICBpZiAoZGlzcGxheVBhcnRpY2xlQ291bnQpIHtcbiAgICAgICAgICAgIGxldCBkb2NGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIGxldCBvYmo7XG5cbiAgICAgICAgICAgIGlmICghKG9iaiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlZ2lvbi5pZCkpKSB7XG4gICAgICAgICAgICAgIG9iaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgICAgICAgICAgICBvYmouaW5uZXJIVE1MID0gcmVnaW9uLnRvdGFsUGFydGljbGVzO1xuICAgICAgICAgICAgICBvYmouaWQgPSByZWdpb24uaWQ7XG4gICAgICAgICAgICAgIG9iai5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICAgICAgICAgICAgb2JqLnN0eWxlLmxlZnQgPSAocmVnaW9uLnggKyAyKSArXCJweFwiO1xuICAgICAgICAgICAgICBvYmouc3R5bGUudG9wID0gKHJlZ2lvbi55IC0gNSkgKyBcInB4XCI7XG4gICAgICAgICAgICAgIG9iai5zdHlsZS5mb250U2l6ZSA9IFwiMC41ZW1cIjtcbiAgICAgICAgICAgICAgb2JqLnN0eWxlLmNvbG9yID0gXCIjRkZGRkZGXCI7XG5cbiAgICAgICAgICAgICAgZG9jRnJhZ21lbnQuYXBwZW5kQ2hpbGQob2JqKTtcbiAgICAgICAgICAgICAgYm9keS5hcHBlbmRDaGlsZChkb2NGcmFnbWVudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG9iai5pbm5lckhUTUwgPSByZWdpb24udG90YWxQYXJ0aWNsZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogIFVwZGF0ZSBwYXJ0aWNsZSdzIHN0YXRlXG4gICAqL1xuICB1cGRhdGVQYXJ0aWNsZXMoKSB7XG4gICAgbGV0IHRvdGFsUGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMubGVuZ3RoO1xuICAgIGZvciAobGV0IGk9MDsgaTx0b3RhbFBhcnRpY2xlczsgaSsrKSB7XG4gICAgICBsZXQgcCA9IHRoaXMucGFydGljbGVzW2ldO1xuXG4gICAgICAvLyBVcGRhdGUgcGFydGljbGUgcG9zaXRpb25cbiAgICAgIHAudXBkYXRlKCk7XG5cbiAgICAgIC8vIFJlZ2lzdGVyIHBhcnRpY2xlIGluIHRoZSBNYXBwZXJcbiAgICAgIHRoaXMubWFwcGVyLnJlZ2lzdGVyKHApO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBDcmVhdGVzIGEgbmV3IG1hcHBlciBsYXllci5cbiAgICogIEBpbnRlcmFjdGlvbjogICBwcmVkZWZpbmVkIGludGVyYWN0aW9uIHwgY2FsbGJhY2tGbihhLCBiKTtcbiAgICovXG4gIGFkZEludGVyYWN0aW9uTWFwKGlkLCBzaXplLCBpbnRlcmFjdGlvbkZuKSB7XG4gICAgdGhpcy5tYXBwZXIuYWRkTGF5ZXIoaWQsIHNpemUsIGludGVyYWN0aW9uRm4pO1xuICB9XG5cbiAgLypcbiAgICogIEZvcmNlIGludGVyYWN0aW9uIGxvb3BcbiAgICovXG4gIHJ1bkludGVyYWN0aW9ucygpIHtcbiAgICBsZXQgdG90YWxJbnRlcmFjdGlvbnMgPSB0aGlzLm1hcHBlci5sYXllcnMubGVuZ3RoO1xuICAgIGZvciAobGV0IGk9MDsgaTx0b3RhbEludGVyYWN0aW9uczsgaSsrKSB7XG4gICAgICB0aGlzLm1hcHBlci5sYXllcnNbaV0uaXRlcmF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBEcmF3IGxvb3BcbiAgICovXG4gIGRyYXcoKSB7XG4gICAgLy8gRHJhdyBtYXBwZXIgcmVnaW9ucyAoZGVidWdnaW5nKVxuICAgIGlmICh0aGlzLkRFQlVHX01PREUpIHtcbiAgICAgIHRoaXMuZGVidWdEcmF3UmVnaW9ucyh0cnVlKTtcbiAgICB9XG5cbiAgICAvLyBEcmF3IHBhcnRpY2xlc1xuICAgIGxldCB0b3RhbFBhcnRpY2xlcyA9IHRoaXMucGFydGljbGVzLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpPTA7IGk8dG90YWxQYXJ0aWNsZXM7IGkrKykge1xuICAgICAgdGhpcy5wYXJ0aWNsZXNbaV0uZHJhdyh0aGlzLmN0eCk7XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogIEFkZCBwYXJ0aWNsZXMgdG8gdGhlIHN5c3RlbSAtIGlmIHRvdGFsIGxlbmd0aCBpcyA+IDE1MDAwMCBvciBzbywgY2hlY2s6XG4gICAqL1xuICBhZGRQYXJ0aWNsZXMoc2V0dGluZ3MpIHtcbiAgICBmb3IgKGxldCBpPTA7IGk8c2V0dGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBwYXJ0aWNsZSA9IG5ldyBQYXJ0aWNsZShzZXR0aW5nc1tpXSk7XG4gICAgICBwYXJ0aWNsZS5pZCA9IFV0aWxzLnVuaXF1ZUlEKCk7XG4gICAgICB0aGlzLnBhcnRpY2xlcy5wdXNoKHBhcnRpY2xlKTtcbiAgICB9XG4gIH1cblxufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICBuZXV0cmFsOiB7XG4gICAgZGVuc2l0eTogMSxcbiAgICBjb2xvcjogXCJyZ2JhKDIwMCwyMDAsMjAwLDAuNilcIixcbiAgICByZXN0aXR1dGlvbjogMVxuICB9LFxuICBpcm9uOiB7XG4gICAgZGVuc2l0eTogMS43ODc0LFxuICAgIGNvbG9yOiBcIiM0MzRiOWRcIixcbiAgICByZXN0aXR1dGlvbjogMC44NVxuICB9LFxuICBzYW5kOiB7XG4gICAgZGVuc2l0eTogMS4xNTUzLFxuICAgIGNvbG9yOiBcInJnYmEoMTk0LCAxNzgsIDEyOCwgMC44KVwiLFxuICAgIHJlc3RpdHV0aW9uOiAwLjMxXG4gIH0sXG4gIHdhdGVyOiB7XG4gICAgZGVuc2l0eTogMC45OTk3LFxuICAgIGNvbG9yOiBcInJnYmEoNjQsIDE2NCwgMjIzLCAwLjYpXCIsXG4gICAgcmVzdGl0dXRpb246IDAuMTNcbiAgfSxcbiAgYWlyOiB7XG4gICAgZGVuc2l0eTogMC4xMjU3LFxuICAgIGNvbG9yOiBcInJnYmEoMTE1LCAyMTYsIDIzNywgMC4zKVwiLFxuICAgIHJlc3RpdHV0aW9uOiAwLjNcbiAgfVxufVxuIiwiLypcbiAqICBGZWF0dXJlIFRvZ2dsaW5nXG4gKlxuICogIEFjdGl2ZXRlL0hpZGUgZmVhdHVyZXMgdGhhdCBhcmUgaW4gcHJvY2VzcyBvZiBkZXZlbG9wbWVudCBvciB1bmRlciB0ZXN0aW5nXG4gKiAgT25jZSBhIGZlYXR1cmUgaXMgYWNjZXB0ZWQgdG8gYmUgaW5jbHVkZGVkIG11c3QgYmUgcmVtb3ZlZCBmcm9tIHRoZVxuICogIGZlYXR1cmUgdG9nZ2xlIHNjaGVtZVxuICovXG5cbiBjb25zdCBGRUFUVVJFX1RPR0dMRSA9IHtcbiAgIEZQU19DT05UUk9MOiB0cnVlICAgICAgICAgICAgICAgIC8vIEZQUyBjb250cm9sbCBmb3IgQW5pbWF0aW9uUGxheWVyIGNsYXNzXG4gfTtcblxuIGV4cG9ydCBkZWZhdWx0IEZFQVRVUkVfVE9HR0xFO1xuIiwiaW1wb3J0IEZFQVRVUkVfVE9HR0xFIGZyb20gJy4uLy4uL3NyYy9mZWF0dXJlLXRvZ2dsZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFuaW1hdGlvblBsYXllciB7XG5cbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MpIHtcbiAgICBzZXR0aW5ncyA9IHNldHRpbmdzIHx8IHt9O1xuXG4gICAgdGhpcy53aW5kb3cgPSBzZXR0aW5ncy53aW5kb3dFbGVtZW50IHx8IHdpbmRvdztcbiAgICB0aGlzLnJlcXVlc3RJZCA9IG51bGw7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG5cbiAgICAvLyBGUFMgY29udHJvbFxuICAgIHRoaXMuZnBzID0gc2V0dGluZ3MuZnBzIHx8IDkwO1xuICAgIHRoaXMubm93O1xuICAgIHRoaXMubGFzdFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuaW50ZXJ2YWwgPSAxMDAwL3RoaXMuZnBzO1xuICAgIHRoaXMuZGVsdGE7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG4gIH1cblxuICByZWdpc3RlckV2ZW50cygpIHtcbiAgICAvLyBBbmltYXRpb24gY29udHJvbDogS2V5RG93blxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJLZXkgcHJlc3NlZDogXCIsIGUua2V5Q29kZSk7XG4gICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICBjYXNlIDI3OiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVzY1xuICAgICAgICBpZiAodGhpcy5wbGF5aW5nKSB7XG4gICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCI+IFNjZW5lIHN0b3BwZWRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wbGF5KCk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCI+IFBsYXlpbmcgc2NlbmVcIik7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIHRoaXMucGxheSgpO1xuICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCI+IFN0ZXAgZm9yd2FyZFwiKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwbGF5KCkge1xuICAgIHRoaXMucGxheWluZyA9IHRydWU7XG4gICAgdGhpcy51cGRhdGVGbigpO1xuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAoIXRoaXMucGxheWluZykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aGlzLndpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJlcXVlc3RJZCk7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5yZXF1ZXN0SWQgPSBudWxsO1xuICB9XG5cbiAgc2V0VXBkYXRlRm4odXBkYXRlRm4pIHtcbiAgICB0aGlzLnVwZGF0ZUZuID0gKFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLnJlcXVlc3RJZCA9IHRoaXMud2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZUZuKTtcbiAgICAgICAgdGhpcy5ub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICB0aGlzLmRlbHRhID0gdGhpcy5ub3cgLSB0aGlzLmxhc3RUaW1lO1xuXG4gICAgICAgIGlmICh0aGlzLmRlbHRhID4gdGhpcy5pbnRlcnZhbCkge1xuICAgICAgICAgIHRoaXMubGFzdFRpbWUgPSB0aGlzLm5vdyAtICh0aGlzLmRlbHRhICUgdGhpcy5pbnRlcnZhbCk7XG4gICAgICAgICAgdXBkYXRlRm4odGhpcy5kZWx0YSwgdGhpcy5sYXN0VGltZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuXG5cbiAgICAgICAgdXBkYXRlRm4oKTtcblxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdXBkYXRlRm4oKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJQbGF5ZXIgdXBkYXRlIGZ1bmN0aW9uIGhhcyBub3QgYmVlbiBzZXQuXCIpO1xuICAgIH1cbiAgfVxuIiwiaW1wb3J0IEZFQVRVUkVfVE9HR0xFIGZyb20gJy4uLy4uL3NyYy9mZWF0dXJlLXRvZ2dsZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhcnRpY2xlIHtcblxuICAvKlxuICAgKiAgIFBhc3MgJ2JveEJvdW5jZScgYXMgeyB3OiA8d2l0aD4sIGg6IDxoZWlnaHQ+IH0gdG8gbWFrZSBwYXJ0aWNsZSBib3VuY2UgaW5zaWRlIGEgYm94XG4gICAqXG4gICAqKi9cbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncykge1xuICAgICAgICB0aGlzLnggPSBzZXR0aW5ncy54IHx8IDA7XG4gICAgICAgIHRoaXMueSA9IHNldHRpbmdzLnkgfHwgMDtcbiAgICAgICAgdGhpcy52eCA9IChNYXRoLmNvcyhzZXR0aW5ncy5kaXJlY3Rpb24pICogc2V0dGluZ3Muc3BlZWQpIHx8IDA7XG4gICAgICAgIHRoaXMudnkgPSAoTWF0aC5zaW4oc2V0dGluZ3MuZGlyZWN0aW9uKSAqIHNldHRpbmdzLnNwZWVkKSB8fCAwO1xuICAgICAgICB0aGlzLmdyYXZpdHkgPSBzZXR0aW5ncy5ncmF2aXR5IHx8IDA7XG4gICAgICAgIHRoaXMubWFzcyA9IHNldHRpbmdzLm1hc3MgfHwgMTtcbiAgICAgICAgdGhpcy5yYWRpdXMgPSBzZXR0aW5ncy5yYWRpdXMgfHwgc2V0dGluZ3MubWFzcyAqIDAuODc7XG4gICAgICAgIHRoaXMuZnJpY3Rpb24gPSBzZXR0aW5ncy5mcmljdGlvbiB8fCAxO1xuICAgICAgICB0aGlzLnNwcmluZ3MgPSBbXTtcbiAgICAgICAgdGhpcy5ncmF2aXRhdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5wb3NpdGlvblVwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb2xvciA9IHNldHRpbmdzLmNvbG9yIHx8ICdyZ2JhKDAsMCwwLDAuNiknO1xuICAgICAgICB0aGlzLmJveEJvdW5jZSA9IHNldHRpbmdzLmJveEJvdW5jZSB8fCBmYWxzZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBVcGRhdGVzIHRoZSBzdGF0ZSBvZiB0aGUgcGFydGljbGVcbiAgICAgKi9cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIGxldCB4ID0gdGhpcy54O1xuICAgICAgICBsZXQgeSA9IHRoaXMueTtcblxuICAgICAgICB0aGlzLmhhbmRsZVNwcmluZ3MoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVHcmF2aXRhdGlvbnMoKTtcbiAgICAgICAgdGhpcy52eSArPSB0aGlzLmdyYXZpdHk7XG4gICAgICAgIHRoaXMudnggKj0gdGhpcy5mcmljdGlvbjtcbiAgICAgICAgdGhpcy52eSAqPSB0aGlzLmZyaWN0aW9uO1xuICAgICAgICB0aGlzLnggKz0gdGhpcy52eDtcbiAgICAgICAgdGhpcy55ICs9IHRoaXMudnk7XG5cbiAgICAgICAgaWYgKHRoaXMuYm94Qm91bmNlKSB7XG4gICAgICAgICAgdGhpcy5jaGVja0JvcmRlcnModGhpcy5ib3hCb3VuY2UudywgdGhpcy5ib3hCb3VuY2UuaCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoeCAhPT0gdGhpcy54ICYmIHkgIT09IHRoaXMueSkge1xuICAgICAgICAgIHRoaXMucG9zaXRpb25VcGRhdGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiAgR2V0cyB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWxvY2l0eSB2ZWN0b3IsIHdoaWNoIGVxdWFscyB0byB0aGUgaHlwb3RlbnVzZVxuICAgICAqL1xuICAgIGdldFNwZWVkKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMudnggKiB0aGlzLnZ4ICsgdGhpcy52eSAqIHRoaXMudnkpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogIFVzaW5nIHRoZSBhY3R1YWwgVmVsb2NpdHkgdmVjdG9yJ3MgYW5nbGUsIHNldHMgYSBuZXcgbGVuZ3RoIGZvciBpdFxuICAgICAqL1xuICAgIHNldFNwZWVkKHNwZWVkKSB7XG4gICAgICAgIGxldCBoZWFkaW5nID0gdGhpcy5nZXRIZWFkaW5nKCk7XG4gICAgICAgIHRoaXMudnggPSBNYXRoLmNvcyhoZWFkaW5nKSAqIHNwZWVkO1xuICAgICAgICB0aGlzLnZ5ID0gTWF0aC5zaW4oaGVhZGluZykgKiBzcGVlZDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBHZXRzIHRoZSBhbmdsZSBkaXJlY3Rpb24gb2YgdGhlIHZlbG9jaXR5IHZlY3RvclxuICAgICAqL1xuICAgIGdldEhlYWRpbmcoKSB7XG4gICAgICAgIHJldHVybiBNYXRoLmF0YW4yKHRoaXMudnksIHRoaXMudngpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogIENoYW5nZXMgdGhlIFZlbG9jaXR5IHZlY3RvcidzIGFuZ2xlIGFuZCByZWNhbGN1bGF0ZSBjb29yZGluYXRlc1xuICAgICAqL1xuICAgIHNldEhlYWRpbmcoaGVhZGluZykge1xuICAgICAgICBsZXQgc3BlZWQgPSB0aGlzLmdldFNwZWVkKCk7XG4gICAgICAgIHRoaXMudnggPSBNYXRoLmNvcyhoZWFkaW5nKSAqIHNwZWVkO1xuICAgICAgICB0aGlzLnZ5ID0gTWF0aC5zaW4oaGVhZGluZykgKiBzcGVlZDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBTdW1zIHRvIHRoZSBWZWxvY2l0eSB2ZWN0b3IgeCBhbmQgeSB2YWx1ZXNcbiAgICAgKi9cbiAgICBhY2NlbGVyYXRlKHgsIHkpIHtcbiAgICAgICAgdGhpcy52eCArPSB4O1xuICAgICAgICB0aGlzLnZ5ICs9IHk7XG4gICAgfVxuXG4gICAgLypcbiAgICAqICBCb3VuY2UgaWYgdGhlIHBhcnRpY2xlIGhpdHMgdGhlIGJveCAoaS5lLiBzY3JlZW4pIGJvcmRlcnNcbiAgICAqL1xuICAgIGNoZWNrQm9yZGVycyh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICBpZiAodGhpcy54ICsgdGhpcy5yYWRpdXMgPj0gd2lkdGgpIHtcbiAgICAgICAgdGhpcy54ID0gd2lkdGggLSB0aGlzLnJhZGl1cztcbiAgICAgICAgdGhpcy52eCAqPSAgLTE7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMueCAtIHRoaXMucmFkaXVzIDw9IDApIHtcbiAgICAgICAgdGhpcy54ID0gdGhpcy5yYWRpdXM7XG4gICAgICAgIHRoaXMudnggKj0gLTE7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnkgKyB0aGlzLnJhZGl1cyA+PSBoZWlnaHQpIHtcbiAgICAgICAgdGhpcy55ID0gaGVpZ2h0IC0gdGhpcy5yYWRpdXM7XG4gICAgICAgIHRoaXMudnkgKj0gIC0xO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnkgLSB0aGlzLnJhZGl1cyA8PSAwKSB7XG4gICAgICAgIHRoaXMueSA9IHRoaXMucmFkaXVzO1xuICAgICAgICB0aGlzLnZ5ICo9IC0xO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qXG4gICAgICogIENhbGN1bGF0ZXMgdGhlIGFuZ2xlIGJldHdlZW4gdGhpcyBwYXJ0aWNsZSBhbmQgJ3AyJ1xuICAgICAqL1xuICAgIGFuZ2xlVG8ocDIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguYXRhbjIocDIueSAtIHRoaXMueSwgcDIueCAtIHRoaXMueCk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiAgQ2FsY3VsYXRlcyB0aGUgZGlzdGFuY2UgdG8gYSBnaXZlbiBwYXJ0aWNsZVxuICAgICAqL1xuICAgIGRpc3RhbmNlVG8ocCkge1xuICAgICAgICBsZXQgZHggPSBwLnggLSB0aGlzLng7XG4gICAgICAgIGxldCBkeSA9IHAueSAtIHRoaXMueTtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiAgQ2FsY3VsYXRlcyBhbmQgYXBwbGllcyBhIGdyYXZpdGF0aW9uIHZlY3RvciB0byBhIGdpdmVuIHBhcnRpY2xlXG4gICAgICovXG4gICAgIGdyYXZpdGF0ZVRvKHAsIGdyYXZpdHlGYWN0b3IpIHtcbiAgICAgICAgIGdyYXZpdHlGYWN0b3IgPSBncmF2aXR5RmFjdG9yIHx8IDAuMDQ7XG5cbiAgICAgICAgIGxldCByYWRpdXNTdW0gPSB0aGlzLnJhZGl1cyArIHAucmFkaXVzO1xuICAgICAgICAgbGV0IG1hc3NGYWN0b3IgPSB0aGlzLm1hc3MgKiBwLm1hc3M7XG5cbiAgICAgICAgIGxldCBkeCA9IHAueCAtIHRoaXMueDtcbiAgICAgICAgIGxldCBkeSA9IHAueSAtIHRoaXMueTtcbiAgICAgICAgIGxldCBkaXN0U1EgPSAoZHggKiBkeCkgKyAoZHkgKiBkeSk7XG4gICAgICAgICBsZXQgZGlzdCA9IE1hdGguc3FydChkaXN0U1EpO1xuICAgICAgICAgbGV0IHN1cmZhY2VEaXN0ID0gZGlzdCAtIHJhZGl1c1N1bTtcblxuICAgICAgICAgLy8gQ2FuY2VsIGdyYXZpdGF0aW9uIG9uY2Ugb2JqZWN0cyBjb2xsaWRlXG4gICAgICAgICAvLyBUT0RPOiBWZXJpZnkgaWYgd2UgY2FuIHNhdmUgdGhlIE1hdGguc3FydCgpIGNvbXBhcmluZyBzcXVhcmVzXG4gICAgICAgICBpZiAoZGlzdCA8IHJhZGl1c1N1bSArIDUpIHtcbiAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgfVxuXG4gICAgICAgICAvL2xldCBmb3JjZSA9IChwLm1hc3MpIC8gZGlzdFNROyAvLyBGb3JjZSA9IG1hc3MgLyBzcXVhcmUgb2YgdGhlIGRpc3RhbmNlXG4gICAgICAgICBsZXQgZm9yY2UgPSBncmF2aXR5RmFjdG9yICogbWFzc0ZhY3RvciAvIChzdXJmYWNlRGlzdCAqIHN1cmZhY2VEaXN0KTtcblxuICAgICAgICAgbGV0IGF4ID0gKGR4IC8gc3VyZmFjZURpc3QpICogZm9yY2U7XG4gICAgICAgICBsZXQgYXkgPSAoZHkgLyBzdXJmYWNlRGlzdCkgKiBmb3JjZTtcblxuICAgICAgICAgdGhpcy52eCArPSBheDtcbiAgICAgICAgIHRoaXMudnkgKz0gYXk7XG4gICAgIH1cblxuICAgIC8qXG4gICAgICogIFJlZ2lzdGVycyBhIHBhcnRpY2xlIHRvIGdyYXZpdGF0ZSB0b1xuICAgICAqL1xuICAgIGFkZEdyYXZpdGF0aW9uKHApIHtcbiAgICAgICAgdGhpcy5yZW1vdmVHcmF2aXRhdGlvbihwKTtcbiAgICAgICAgdGhpcy5ncmF2aXRhdGlvbnMucHVzaChwKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBVbnJlZ2lzdGVycyBhIGdyYXZpdGF0aW9uIHBhcnRpY2xlXG4gICAgICovXG4gICAgcmVtb3ZlR3Jhdml0YXRpb24ocCkge1xuICAgICAgICBsZXQgbGVuZ3RoID0gdGhpcy5ncmF2aXRhdGlvbnMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpPTA7IGk8bGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYgKHRoaXMuZ3Jhdml0YXRpb25zW2ldID09PSBwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmF2aXRhdGlvbnMuc2xpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBHcmF2aXRhdGVzIHRvIGVhY2ggcmVnaXN0ZXJlZCBncmF2aXRhdGlvbiBwYXJ0aWNsZVxuICAgICAqL1xuICAgIGhhbmRsZUdyYXZpdGF0aW9ucygpIHtcbiAgICAgICAgbGV0IGxlbmd0aCA9IHRoaXMuZ3Jhdml0YXRpb25zLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaT0wOyBpPGxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHRoaXMuZ3Jhdml0YXRlVG8odGhpcy5ncmF2aXRhdGlvbnNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiAgQ2FsY3VsYXRlcyBhbmQgYXBwbGllcyBhIHNwcmluZyB2ZWN0b3IgdG8gYSBnaXZlbiBwb2ludFxuICAgICAqL1xuICAgIHNwcmluZ1RvKHBvaW50LCBrLCBsZW5ndGgpIHtcbiAgICAgICAgbGV0IGR4ID0gcG9pbnQueCAtIHRoaXMueDtcbiAgICAgICAgbGV0IGR5ID0gcG9pbnQueSAtIHRoaXMueTtcbiAgICAgICAgbGV0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcbiAgICAgICAgbGV0IGZvcmNlID0gKGRpc3RhbmNlIC0gbGVuZ3RoIHx8IDApICogaztcbiAgICAgICAgLy8gSW5zdGVhZCBvZiBnZXR0aW5nIGNvcyAvIHNpbiBvZiBhbmdsZSwgZGl2aWRlIHNpZGVzIGJ5IGh5cG90ZW51c2VcbiAgICAgICAgdGhpcy52eCArPSAoZHggLyBkaXN0YW5jZSkgKiBmb3JjZTtcbiAgICAgICAgdGhpcy52eSArPSAoZHkgLyBkaXN0YW5jZSkgKiBmb3JjZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBSZWdpc3RlcnMgYSBuZXcgc3ByaW5nIHBvaW50XG4gICAgICovXG4gICAgYWRkU3ByaW5nKHBvaW50LCBrLCBsZW5ndGgpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVTcHJpbmcocG9pbnQpO1xuICAgICAgICB0aGlzLnNwcmluZ3MucHVzaCh7XG4gICAgICAgICAgICBwb2ludDogcG9pbnQsXG4gICAgICAgICAgICBrOiBrLFxuICAgICAgICAgICAgbGVuZ3RoOiBsZW5ndGggfHwgMFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqICBVbnJlZ2lzdGVycyBhIHNwcmluZyBwb2ludFxuICAgICAqL1xuICAgIHJlbW92ZVNwcmluZyhwb2ludCkge1xuICAgICAgICBsZXQgbGVuZ3RoID0gdGhpcy5zcHJpbmdzLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaT0wOyBpPGxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwcmluZ3NbaV0ucG9pbnQgPT09IHBvaW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcHJpbmdzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qXG4gICAgICogIFNwcmluZ3MgdG8gZWFjaCByZWdpc3RlcmVkIHNwcmluZyBwb2ludFxuICAgICAqL1xuICAgIGhhbmRsZVNwcmluZ3MoKSB7XG4gICAgICAgIGxldCBsZW5ndGggPSB0aGlzLnNwcmluZ3MubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpPTA7IGk8bGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IHNwcmluZyA9IHRoaXMuc3ByaW5nc1tpXTtcbiAgICAgICAgICAgIHRoaXMuc3ByaW5nVG8oc3ByaW5nLnBvaW50LCBzcHJpbmcuaywgc3ByaW5nLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgRkVBVFVSRV9UT0dHTEUgZnJvbSAnLi4vLi4vc3JjL2ZlYXR1cmUtdG9nZ2xlJztcblxuY2xhc3MgVXRpbHMge1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2FjaGUgPSB7fTtcbiAgfVxuXG4gIGNhY2hlU3RvcmUoY2FsbGVyLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmNhY2hlLmhhc093blByb3BlcnR5KGNhbGxlcikpIHtcbiAgICAgIHRoaXMuY2FjaGVbY2FsbGVyXSA9IHt9O1xuICAgIH1cbiAgICB0aGlzLmNhY2hlW2NhbGxlcl1ba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgY2FjaGVSZXRyaWV2ZShjYWxsZXIsIGtleSkge1xuICAgIGxldCBmbkNhY2hlID0gdGhpcy5jYWNoZVtjYWxsZXJdIHx8IFtdO1xuICAgIGxldCB2YWx1ZSA9IGZuQ2FjaGVba2V5XSB8fCBmYWxzZTtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICAvKlxuICAgKiAgR2V0ICduJyBwb2ludHMgZnJvbSBhIGNpcmN1bGFyIHNoYXBlZCAnUGFydGljbGUnIG9iamVjdFxuICAgKi9cbiAgZ2V0Q2lyY2xlUG9pbnRzKHAsIG4sIHJhZGl1cykge1xuICAgIG4gPSBuIHx8IDg7XG4gICAgcmFkaXVzID0gcmFkaXVzIHx8IHAucmFkaXVzIHx8IDA7XG5cbiAgICBsZXQgYW5nbGUgPSAtMTtcbiAgICBsZXQgYW5nbGVTdGVwID0gKE1hdGguUEkgKiAyKSAvIG47XG4gICAgbGV0IHBvaW50cyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaT0wOyBpPG47IGkrKykge1xuICAgICAgbGV0IGNEYXRhID0gdGhpcy5jYWNoZVJldHJpZXZlKFwiZ2V0Q2lyY2xlUG9pbnRzXCIsIGFuZ2xlKTtcbiAgICAgIGxldCBjb3MgPSBjRGF0YS5jb3MgfHwgTWF0aC5jb3MoYW5nbGUpO1xuICAgICAgbGV0IHNpbiA9IGNEYXRhLnNpbiB8fCBNYXRoLnNpbihhbmdsZSk7XG4gICAgICBsZXQgcHQgPSB7XG4gICAgICAgIHg6IHAueCArIChjb3MgKiBwLnJhZGl1cyksXG4gICAgICAgIHk6IHAueSArIChzaW4gKiBwLnJhZGl1cylcbiAgICAgIH07XG4gICAgICBwb2ludHMucHVzaChwdCk7XG4gICAgICBpZiAoIWNEYXRhKSB7XG4gICAgICAgIHRoaXMuY2FjaGVTdG9yZShcImdldENpcmNsZVBvaW50c1wiLCBhbmdsZSwge2NvczogY29zLCBzaW46IHNpbn0pO1xuICAgICAgfVxuICAgICAgYW5nbGUgKz0gYW5nbGVTdGVwO1xuICAgIH1cblxuICAgIC8vIEFkZCB0aGUgY2VudGVyIHBvaW50XG4gICAgcmV0dXJuIHBvaW50cztcbiAgfVxuXG4gIG1vbnRlY2FybG8oKSB7XG4gICAgd2hpbGUodHJ1ZSkge1xuICAgICAgbGV0IHIxID0gTWF0aC5yYW5kb20oKTtcbiAgICAgIGxldCBwID0gcjE7XG4gICAgICBsZXQgcjIgPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgaWYgKHIyIDwgcCkge1xuICAgICAgICByZXR1cm4gcjE7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbGVycChub3JtLCBtaW4sIG1heCkge1xuICAgIHJldHVybiAobWF4IC0gbWluKSAqIG5vcm0gKyBtaW47XG4gIH1cblxuICBxdWFkcmF0aWNCZXppZXIocDAsIHAxLCBwMiwgdCwgcEZpbmFsKSB7XG4gICAgcEZpbmFsID0gcEZpbmFsIHx8IHt9O1xuICAgIHBGaW5hbC54ID0gTWF0aC5wb3coMSAtIHQsIDIpICogcDAueCArICgxIC0gdCkgKiAyICogdCAqIHAxLnggKyB0ICogdCAqIHAyLng7XG4gICAgcEZpbmFsLnkgPSBNYXRoLnBvdygxIC0gdCwgMikgKiBwMC55ICsgKDEgLSB0KSAqIDIgKiB0ICogcDEueSArIHQgKiB0ICogcDIueTtcbiAgICByZXR1cm4gcEZpbmFsO1xuICB9XG5cbiAgY3ViaWNCZXppZXIocDAsIHAxLCBwMiwgcDMsIHQsIHBGaW5hbCkge1xuICAgIHBGaW5hbCA9IHBGaW5hbCB8fCB7fTtcbiAgICBwRmluYWwueCA9IE1hdGgucG93KDEgLSB0LCAzKSAqIHAwLnggKyBNYXRoLnBvdygxIC0gdCwgMikgKiAzICogdCAqIHAxLnggKyAoMSAtIHQpICogMyAqIHQgKiB0ICogcDIueCArIHQgKiB0ICogdCAqIHAzLng7XG4gICAgcEZpbmFsLnkgPSBNYXRoLnBvdygxIC0gdCwgMykgKiBwMC55ICsgTWF0aC5wb3coMSAtIHQsIDIpICogMyAqIHQgKiBwMS55ICsgKDEgLSB0KSAqIDMgKiB0ICogdCAqIHAyLnkgKyB0ICogdCAqIHQgKiBwMy55O1xuICAgIHJldHVybiBwRmluYWw7XG4gIH1cblxuICBkaXN0YW5jZShwMCwgcDEpIHtcbiAgICBsZXQgZHggPSBwMC54IC0gcDEueDtcbiAgICBsZXQgZHkgPSBwMC55IC0gcDEueTtcbiAgICByZXR1cm4gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcbiAgfVxuXG4gIGRpc3RhbmNlWFkoeDAsIHkwLCB4MSwgeTEpIHtcbiAgICBsZXQgZHggPSB4MSAtIHgwO1xuICAgIGxldCBkeSA9IHkxIC0geTA7XG4gICAgcmV0dXJuIE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG4gIH1cblxuICAvLyBUT0RPOiBDaGVjayBpZiBhbmQgd2h5IHdlIG5lZWQgdG8gcGFyc2VJbnQoKSB0aGUgcmVzdWx0XG4gIG1hcFJhbmdlKHZhbHVlLCBsb3cxLCBoaWdoMSwgbG93MiwgaGlnaDIpIHtcbiAgICByZXR1cm4gcmVzdWx0ID0gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbiAgICBsZXQgcmVzdWx0ID0gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbiAgICBpZiAobG93MiA9PT0gcGFyc2VJbnQobG93MiwgMTApIHx8IGhpZ2gyID09PSBwYXJzZUludChoaWdoMiwgMTApKSB7XG4gICAgICByZXN1bHQgPSBwYXJzZUludChyZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgaW5SYW5nZSh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICByZXR1cm4gdmFsdWUgPj0gTWF0aC5taW4obWluLCBtYXgpICYmIHZhbHVlIDw9IE1hdGgubWF4KG1pbiwgbWF4KTtcbiAgfVxuXG4gIHJhbmdlSW50ZXJzZWN0KG1pbjAsIG1heDAsIG1pbjEsIG1heDEpIHtcbiAgICByZXR1cm4gIE1hdGgubWF4KG1pbjAsIG1heDApID49IE1hdGgubWluKG1pbjEsIG1heDEpICYmXG4gICAgTWF0aC5taW4obWluMCwgbWF4MCkgPD0gTWF0aC5tYXgobWluMSwgbWF4MSk7XG4gIH1cblxuICByYW5kb21SYW5nZShtaW4sIG1heCkge1xuICAgIHJldHVybiBtaW4gKyBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbik7XG4gIH1cblxuICBjb25zdHJhaW4oZSx0LHIpIHtcbiAgICByZXR1cm4gZT5yP3I6ZTx0P3Q6ZTtcbiAgfVxuXG4gIGNpcmNsZUNvbGxpc2lvbihjMCwgYzEpIHtcbiAgICByZXR1cm4gdGhpcy5kaXN0YW5jZShjMCwgYzEpIDw9IGMwLnJhZGl1cyArIGMxLnJhZGl1cztcbiAgfVxuXG4gIHJlY3RhbmdsZUNvbGxpc2lvbihyMCwgcjEpIHtcbiAgICByZXR1cm4gIHRoaXMucmFuZ2VJbnRlcnNlY3QocjAueCwgcjAueCArIHIwLndpZHRoLCByMS54LCByMS54ICsgcjEud2lkdGgpICYmXG4gICAgdGhpcy5yYW5nZUludGVyc2VjdChyMC55LCByMC55ICsgcjAuaGVpZ2h0LCByMS55LCByMS55ICsgcjEuaGVpZ2h0KTtcbiAgfVxuXG4gIGNpcmNsZVBvaW50Q29sbGlzaW9uKHB4LCBweSwgY2lyY2xlKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzdGFuY2VYWShweCwgcHksIGNpcmNsZS54LCBjaXJjbGUueSkgPCBjaXJjbGUucmFkaXVzO1xuICB9XG5cbiAgcmVjdGFuZ2xlUG9pbnRDb2xsaXNpb24ocHgsIHB5LCByZWN0KSB7XG4gICAgcmV0dXJuICB0aGlzLmluUmFuZ2UocHgsIHJlY3QueCwgcmVjdC54ICsgcmVjdC53aWR0aCkgJiZcbiAgICB0aGlzLmluUmFuZ2UocHksIHJlY3QueSwgcmVjdC55ICsgcmVjdC5oZWlnaHQpO1xuICB9XG5cbiAgdW5pcXVlSUQoKSB7XG4gICAgZnVuY3Rpb24gczQoKSB7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAgICAgLnRvU3RyaW5nKDE2KVxuICAgICAgICAuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArXG4gICAgICBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuICB9XG5cbiAgcmFuZG9tQ29sb3IoKSB7XG4gICAgcmV0dXJuIFwiIzAwMDAwMFwiLnJlcGxhY2UoLzAvZyxmdW5jdGlvbigpe3JldHVybiAofn4oTWF0aC5yYW5kb20oKSoxNikpLnRvU3RyaW5nKDE2KTt9KTtcbiAgfVxufVxuXG5sZXQgaW5zdGFuY2UgPSBuZXcgVXRpbHMoKTtcblxuZXhwb3J0IGRlZmF1bHQgaW5zdGFuY2U7XG4iXX0="}