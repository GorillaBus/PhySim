{"version":3,"sources":["node_modules/browser-pack/_prelude.js","projects/test/app.js","src/feature-toggle.js","src/lib/AnimationPlayer.js"],"names":[],"mappings":"AAAA;;;ACAA;;;;;;AAEA,OAAO,MAAP,GAAgB,YAAM;AAClB,QAAM,SAAS,SAAS,cAAT,CAAwB,QAAxB,CAAf;AACA,QAAM,MAAM,OAAO,UAAP,CAAkB,IAAlB,CAAZ;AACA,QAAM,QAAQ,OAAO,UAArB;AACA,QAAM,SAAS,OAAO,WAAP,GAAmB,CAAlC;AACA,QAAM,SAAS,EAAE,GAAG,QAAM,CAAX,EAAc,GAAG,SAAO,CAAxB,EAAf;;AAEA,WAAO,MAAP,GAAgB,MAAhB;AACA,WAAO,KAAP,GAAe,KAAf;;AAGA,QAAI,SAAS,MAAM,MAAN,CAAa,IAAb,CAAkB,MAA/B;AAAA,QACG,YAAY,MAAM,QAAN,CAAe,SAD9B;AAAA,QAEG,SAAS,MAAM,QAAN,CAAe,MAF3B;AAAA,QAGG,eAAe,MAAM,QAAN,CAAe,YAHjC;AAAA,QAIG,YAAY,MAAM,QAAN,CAAe,SAJ9B;AAAA,QAKG,UAAU,MAAM,QAAN,CAAe,OAL5B;AAAA,QAMG,aAAa,MAAM,SAAN,CAAgB,MAAhB,CAAuB,UANvC;AAAA,QAOG,iBAAiB,MAAM,SAAN,CAAgB,MAAhB,CAAuB,cAP3C;AAAA,QAQG,gBAAgB,MAAM,SAAN,CAAgB,MAAhB,CAAuB,aAR1C;AAAA,QASG,cAAc,MAAM,QAAN,CAAe,WAThC;;AAaC,QAAI,QAAQ,IAAI,OAAJ,CACN,IAAI,MAAJ,CAAW,CAAX,EAAc,EAAd,CADM,CACe;AADf,MAEN,IAFM,CAEe;AAFf,KAAZ;;AAKA,QAAI,QAAQ,EAAZ;;AAEA;AACA,QAAI,SAAS,IAAI,YAAJ,EAAb;AACA,WAAO,OAAP,GAAiB,GAAjB;AACA,WAAO,QAAP,GAAkB,GAAlB;AACA,WAAO,WAAP,GAAqB,GAArB;AACA,WAAO,KAAP,GAAe,IAAI,aAAJ,CAAkB,EAAlB,CAAf;;AAEA,QAAI,UAAU,IAAI,SAAJ,EAAd;AACA,YAAQ,IAAR,GAAe,OAAO,cAAtB;;AAEA;AACA,YAAQ,QAAR,CAAiB,CAAjB,GAAqB,OAAO,CAAP,GAAW,KAAhC;AACA,YAAQ,QAAR,CAAiB,CAAjB,GAAqB,KAAK,KAA1B;AACA,YAAQ,QAAR,GAAmB,KAAnB;;AAEA,UAAM,UAAN,CAAiB,OAAjB,EAA0B,aAA1B,CAAwC,MAAxC;;AAID,QAAI,SAAS,8BAAoB,EAAE,KAAK,EAAP,EAApB,CAAb;;AAEA;AACA,WAAO,WAAP,CAAmB,MAAnB;AACA,WAAO,IAAP;;AAEA;AACA,aAAS,MAAT,GAAkB;AACd,YAAI,SAAJ,CAAc,CAAd,EAAgB,CAAhB,EAAmB,KAAnB,EAA0B,MAA1B;;AAEA,cAAM,IAAN,CACK,KAAK,IADV,CACiB;AADjB,UAEK,EAFL,CAEc;AAFd,UAGK,EAHL,CAGc;AAHd;;AAMA,YAAI,QAAQ,EAAZ;AACA,aAAK,IAAI,IAAI,MAAM,WAAN,EAAb,EAAkC,CAAlC,EAAqC,IAAI,EAAE,MAA3C,EAAmD;AACjD,gBAAI,EAAE,QAAF,MAAgB,OAAO,EAAE,WAAF,EAAP,KAA2B,WAA3C,IAA0D,EAAE,WAAF,MAAmB,IAAjF,EAAuF;AACnF,sBAAM,EAAE,WAAF,EAAN,IAAyB,EAAC,GAAG,EAAE,WAAF,GAAgB,CAApB,EAAuB,GAAG,EAAE,WAAF,GAAgB,CAA1C,EAA6C,GAAG,EAAE,QAAF,EAAhD,EAAzB;AACH;AACF;;AAED;AACA,YAAI,SAAJ;AACA,YAAI,GAAJ,CAAQ,MAAM,GAAN,EAAW,CAAX,GAAe,KAAvB,EAA8B,MAAM,GAAN,EAAW,CAAX,GAAe,KAA7C,EAAoD,EAApD,EAAwD,CAAxD,EAA2D,KAAK,EAAL,GAAU,CAArE,EAAwE,KAAxE;AACA,YAAI,SAAJ,GAAgB,SAAhB;AACA,YAAI,IAAJ;AACA,YAAI,SAAJ;AACA,YAAI,MAAJ;AACH;;AAED;AACA,aAAS,IAAT,CAAc,gBAAd,CAA+B,SAA/B,EAA0C,UAAC,CAAD,EAAO;AAC7C;AACA,gBAAQ,EAAE,OAAV;AACI,iBAAK,EAAL;AAAgC;AAC9B,oBAAI,OAAO,OAAX,EAAoB;AAChB,2BAAO,IAAP;AACA,4BAAQ,GAAR,CAAY,iBAAZ;AACH,iBAHD,MAGO;AACH,2BAAO,IAAP;AACA,4BAAQ,GAAR,CAAY,iBAAZ;AACH;AACH;;AAEA,iBAAK,EAAL;AACE,uBAAO,IAAP;AACA,uBAAO,IAAP;AACA,uBAAO,IAAP;AACA,wBAAQ,GAAR,CAAY,gBAAZ;AACF;;AAEA;AACE;AAnBN;AAqBH,KAvBD;AAyBH,CA5GD;;;;;;;;ACFA;;;;;;;;AAQC,IAAM,iBAAiB;AACrB,eAAa,IADQ,CACY;AADZ,CAAvB;;kBAIe,c;;;;;;;;;;;ACZhB;;;;;;;;IAEqB,e;AAEjB,6BAAY,QAAZ,EAAsB;AAAA;;AAClB,mBAAW,YAAY,EAAvB;;AAEA,aAAK,MAAL,GAAc,SAAS,aAAT,IAA0B,MAAxC;AACA,aAAK,SAAL,GAAiB,IAAjB;AACA,aAAK,OAAL,GAAe,KAAf;;AAEA;AACA,YAAI,wBAAe,WAAnB,EAAgC;AAC9B,iBAAK,GAAL,GAAW,SAAS,GAAT,IAAgB,EAA3B;AACA,iBAAK,GAAL;AACA,iBAAK,QAAL,GAAgB,KAAK,GAAL,EAAhB;AACA,iBAAK,QAAL,GAAgB,OAAK,KAAK,GAA1B;AACA,iBAAK,KAAL;AACD;AAEJ;;;;+BAEM;AACH,iBAAK,OAAL,GAAe,IAAf;AACA,iBAAK,QAAL;AACH;;;+BAEM;AACH,gBAAI,CAAC,KAAK,OAAV,EAAmB;AACf,uBAAO,KAAP;AACH;AACD,iBAAK,MAAL,CAAY,oBAAZ,CAAiC,KAAK,SAAtC;AACA,iBAAK,OAAL,GAAe,KAAf;AACA,iBAAK,SAAL,GAAiB,IAAjB;AACH;;;oCAEW,Q,EAAU;AAAA;;AAClB,iBAAK,QAAL,GACI,YAAM;AACF,sBAAK,SAAL,GAAiB,MAAK,MAAL,CAAY,qBAAZ,CAAkC,MAAK,QAAvC,CAAjB;;AAEA;AACA,oBAAI,wBAAe,WAAnB,EAAgC;AAC9B,0BAAK,GAAL,GAAW,KAAK,GAAL,EAAX;AACA,0BAAK,KAAL,GAAa,MAAK,GAAL,GAAW,MAAK,QAA7B;;AAEA,wBAAI,MAAK,KAAL,GAAa,MAAK,QAAtB,EAAgC;AAC9B,8BAAK,QAAL,GAAgB,MAAK,GAAL,GAAY,MAAK,KAAL,GAAa,MAAK,QAA9C;AACA;AACD;AACD;AACD;;AAED;AAEH,aAlBL;AAmBH;;;mCAEU;AACP,oBAAQ,IAAR,CAAa,0CAAb;AACH;;;;;;kBA1DgB,e","file":"app.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import AnimationPlayer from '../../src/lib/AnimationPlayer';\n\nwindow.onload = () => {\n    const canvas = document.getElementById(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    const width = window.innerWidth;\n    const height = window.innerHeight-4;\n    const center = { x: width/2, y: height/2 };\n\n    canvas.height = height;\n    canvas.width = width;\n\n\n    let b2Vec2 = Box2D.Common.Math.b2Vec2\n     , b2BodyDef = Box2D.Dynamics.b2BodyDef\n     , b2Body = Box2D.Dynamics.b2Body\n     , b2FixtureDef = Box2D.Dynamics.b2FixtureDef\n     , b2Fixture = Box2D.Dynamics.b2Fixture\n     , b2World = Box2D.Dynamics.b2World\n     , b2MassData = Box2D.Collision.Shapes.b2MassData\n     , b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape\n     , b2CircleShape = Box2D.Collision.Shapes.b2CircleShape\n     , b2DebugDraw = Box2D.Dynamics.b2DebugDraw;\n\n\n\n     let world = new b2World(\n           new b2Vec2(0, 10)    //gravity\n        ,  true                 //allow sleep\n     );\n\n     let SCALE = 30;\n\n     //create ground\n     let fixDef = new b2FixtureDef;\n     fixDef.density = 1.0;\n     fixDef.friction = 0.5;\n     fixDef.restitution = 0.2;\n     fixDef.shape = new b2CircleShape(10);\n\n     let bodyDef = new b2BodyDef;\n     bodyDef.type = b2Body.b2_dynamicBody;\n\n     // positions the center of the object (not upper left!)\n     bodyDef.position.x = center.x / SCALE;\n     bodyDef.position.y = 10 / SCALE;\n     bodyDef.userData = \"123\";\n\n     world.CreateBody(bodyDef).CreateFixture(fixDef);\n\n\n\n    let player = new AnimationPlayer({ fps: 60 });\n\n    // Demo player setup\n    player.setUpdateFn(update);\n    player.play();\n\n    // Frame drawing function\n    function update() {\n        ctx.clearRect(0,0, width, height);\n\n        world.Step(\n             60 / 1000   //frame-rate\n          ,  10       //velocity iterations\n          ,  10       //position iterations\n       );\n\n        let state = {};\n        for (let b = world.GetBodyList(); b; b = b.m_next) {\n          if (b.IsActive() && typeof b.GetUserData() !== 'undefined' && b.GetUserData() != null) {\n              state[b.GetUserData()] = {x: b.GetPosition().x, y: b.GetPosition().y, a: b.GetAngle()};\n          }\n        }\n\n        // Draw\n        ctx.beginPath();\n        ctx.arc(state[123].x * SCALE, state[123].y * SCALE, 10, 0, Math.PI * 2, false);\n        ctx.fillStyle = \"#000000\";\n        ctx.fill();\n        ctx.closePath();\n        ctx.stroke();\n    }\n\n    // Animation control: KeyDown\n    document.body.addEventListener(\"keydown\", (e) => {\n        //console.log(\"Key pressed: \", e.keyCode);\n        switch (e.keyCode) {\n            case 27:                        // Esc\n              if (player.playing) {\n                  player.stop();\n                  console.log(\"> Scene stopped\");\n              } else {\n                  player.play();\n                  console.log(\"> Playing scene\");\n              }\n            break;\n\n            case 13:\n              player.stop();\n              player.play();\n              player.stop();\n              console.log(\"> Step forward\");\n            break;\n\n            default:\n              break;\n        }\n    });\n\n};\n","/*\n *  Feature Toggling\n *\n *  Activete/Hide features that are in process of development or under testing\n *  Once a feature is accepted to be includded must be removed from the\n *  feature toggle scheme\n */\n\n const FEATURE_TOGGLE = {\n   FPS_CONTROL: true                // FPS controll for AnimationPlayer class\n };\n\n export default FEATURE_TOGGLE;\n","import FEATURE_TOGGLE from '../../src/feature-toggle';\n\nexport default class AnimationPlayer {\n\n    constructor(settings) {\n        settings = settings || {};\n\n        this.window = settings.windowElement || window;\n        this.requestId = null;\n        this.playing = false;\n\n        // FPS control\n        if (FEATURE_TOGGLE.FPS_CONTROL) {\n          this.fps = settings.fps || 90;\n          this.now;\n          this.lastTime = Date.now();\n          this.interval = 1000/this.fps;\n          this.delta;\n        }\n\n    }\n\n    play() {\n        this.playing = true;\n        this.updateFn();\n    }\n\n    stop() {\n        if (!this.playing) {\n            return false;\n        }\n        this.window.cancelAnimationFrame(this.requestId);\n        this.playing = false;\n        this.requestId = null;\n    }\n\n    setUpdateFn(updateFn) {\n        this.updateFn = (\n            () => {\n                this.requestId = this.window.requestAnimationFrame(this.updateFn);\n\n                // FPS control\n                if (FEATURE_TOGGLE.FPS_CONTROL) {\n                  this.now = Date.now();\n                  this.delta = this.now - this.lastTime;\n\n                  if (this.delta > this.interval) {\n                    this.lastTime = this.now - (this.delta % this.interval);\n                    updateFn();\n                  }\n                  return;\n                }\n\n                updateFn();\n\n            });\n    }\n\n    updateFn() {\n        console.warn(\"Player update function has not been set.\");\n    }\n}\n"]}