<!DOCTYPE html>
<html>
<head>
    <title>Vector Class Demo</title>
    <link rel="stylesheet" type="text/css" href="demos.css" />
    <script>
    var requestId;
    // Browser compatibility hack
    var module = function() {
        this.exports = function() { };
    };
    window.onload = function() {
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var width = canvas.width = window.innerWidth-4;
        var height = canvas.height = window.innerHeight-4;

        var shipSettings = {
            x: width / 2,
            y: height / 2
        }
        var ship = Particle.create(shipSettings);
        var thrust = Vector.create(0,0);

        update();

        function update() {
            ctx.clearRect(0,0, width, height);            

            ship.accelerate(thrust);
            ship.update();

            ctx.beginPath();
            ctx.arc(ship.position.getX(), ship.position.getY(), 10, 0, Math.PI * 2, false);
            ctx.fill();

            if (ship.position.getX() > width) {
                ship.position.setX(0);
            }
            if (ship.position.getY() > height) {
                ship.position.setY(0);
            }
            if (ship.position.getX() < 0) {
                ship.position.setX(width);
            }
            if (ship.position.getY() < 0) {
                ship.position.setY(height);
            }

            requestId = requestAnimationFrame(update);
        }

        // Animation control: KeyDown
        document.body.addEventListener("keydown", function(e) {
            switch (e.keyCode) {
                case 38:                        // Up
                    thrust.setY(-0.1);
                    break;
                case 40:                        // Down
                    thrust.setY(0.1);
                    break;
                case 37:                        // Left
                    thrust.setX(-0.1);
                    break;
                case 39:                        // Right
                    thrust.setX(0.1);
                    break;  
                case 27:                        // Esc
                    if (requestId) {
                        window.cancelAnimationFrame(requestId);
                        requestId = undefined;
                        console.log("> Scene stopped");
                    }
                    break;
                default:
                    break;
            }
        });

        // Animation control: KeyUp
        document.body.addEventListener("keyup", function(e) {
            switch (e.keyCode) {
                case 38:                        // Up
                    thrust.setY(0);
                    break;
                case 40:                        // Down
                    thrust.setY(0);
                    break;
                case 37:                        // Left
                    thrust.setX(0);
                    break;
                case 39:                        // Right
                    thrust.setX(0);
                    break; 
                default:
                    break;
            }
        });
    };
    </script>

    <script src="../lib/vector.js" type="text/javascript"></script>
    <script src="../lib/particle.js" type="text/javascript"></script> 
    </head>
<body>
<canvas id="canvas"></canvas>
</body>
</html>