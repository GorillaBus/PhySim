<!DOCTYPE html>
<html>
<head>
    <title>Vector Class Demo</title>
    <link rel="stylesheet" type="text/css" href="./demos.css" />
    <script>

    var player;
    
    // Browser compatibility hack
    var module = function() {
        this.exports = function() { };
    };

    window.onload = function() {
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var width = canvas.width = window.innerWidth-4;
        var height = canvas.height = window.innerHeight-4;

        var startY = height / 2;
        var baseX = width / 4;
        
        var _sunCfg = {
            x: baseX,
            y: startY,
            mass: 5000,
            direction: -Math.PI * 360,
            speed: 0.4
        };
        var _earthCfg = {
            x: baseX - 190,
            y: startY,
            speed: 5,
            direction: -Math.PI / 2
        };
        var _saturnCfg = {
            x: baseX - 290,
            y: startY,
            speed: 4,
            direction: -Math.PI / 2
        };
        var _chanakaCfg = {
            x: baseX - 390,
            y: startY,
            speed: 3,
            direction: -Math.PI / 2
        };
        var _borlanCfg = {
            x: baseX - 650,
            y: startY,
            speed: 2,
            direction: -Math.PI / 2
        };  
        var sun = Particle.create(_sunCfg);
        var earth = Particle.create(_earthCfg);
        var saturn = Particle.create(_saturnCfg);
        var borlan = Particle.create(_borlanCfg);
        var chanaka = Particle.create(_chanakaCfg);

        // Demo player
        player = AnimationPlayer.create();        
        player.setUpdateFn(update);
        player.play();


        // Frame drawing function
        function update(updateFn) {
            ctx.clearRect(0,0, width, height);            

            earth.gravitateTo(sun);
            saturn.gravitateTo(sun);
            borlan.gravitateTo(sun);
            chanaka.gravitateTo(sun);
            earth.update();
            saturn.update();
            borlan.update();
            chanaka.update();
            sun.update();

            ctx.beginPath();
            ctx.fillStyle = "#e1d70e";
            ctx.arc(sun.position.getX(), sun.position.getY(), 52, 0, Math.PI * 2, false);
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.fillStyle = "#1f5309";
            ctx.arc(earth.position.getX(), earth.position.getY(), 2.5, 0, Math.PI * 2, false);
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.fillStyle = "#613b0a";
            ctx.arc(saturn.position.getX(), saturn.position.getY(), 5.3, 0, Math.PI * 2, false);
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.fillStyle = "#084e2e";
            ctx.arc(borlan.position.getX(), borlan.position.getY(), 7.2, 0, Math.PI * 2, false);
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.fillStyle = "#100a6b";
            ctx.arc(chanaka.position.getX(), chanaka.position.getY(), 7.2, 0, Math.PI * 2, false);
            ctx.fill();
            ctx.closePath(); 
        }



        // Animation control: KeyDown
        document.body.addEventListener("keydown", function(e) {
            //console.log("Key pressed: ", e.keyCode);
            switch (e.keyCode) {
                case 38:                        // Up
                    thrusting = true;
                    break;
                case 37:                        // Left
                    turningLeft = true;
                    break;
                case 39:                        // Right
                    turningRight = true;
                    break;
                case 27:                        // Esc
                    if (player.playing) {
                        player.stop();
                        console.log("> Scene stopped");
                    } else {
                        player.play();
                        console.log("> Playing scene");
                    }
                    break;
                default:
                    break;
            }
        });

        // Animation control: KeyUp
        document.body.addEventListener("keyup", function(e) {
            switch (e.keyCode) {
                case 38:                        // Up
                    thrusting = false;
                    break;
                case 37:                        // Left
                    turningLeft = false;
                    break;
                case 39:                        // Right
                    turningRight = false;
                    break;
                case 32:                        // Space
                    firing = true;
                    setTimeout(function() {
                        firing = false;
                    }, 20);
                    break;
                default:
                    break;
            }
        });
    };
    </script>

    <script src="../lib/Vector.js" type="text/javascript"></script>
    <script src="../lib/Particle.js" type="text/javascript"></script>
    <script src="../lib/AnimationPlayer.js" type="text/javascript"></script>
    </head>
<body id="gravityDemo">
<canvas id="canvas"></canvas>
</body>
</html>