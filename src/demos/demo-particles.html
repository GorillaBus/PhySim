<!DOCTYPE html>
<html>
<head>
    <title>Vector Class Demo</title>
    <link rel="stylesheet" type="text/css" href="demos.css" />
    <script>

    var player;

    // Browser compatibility hack
    var module = function() {
        this.exports = function() { };
    };

    window.onload = function() {
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var width = canvas.width = window.innerWidth-4;
        var height = canvas.height = window.innerHeight-4;

        // Particles setup
        var particles = [];
        var numParticles = 100;
        for (var i=0;i<numParticles;i++) {
            var particleSettings = {
                x: width/2,
                y: height/2,
                speed: Math.random() * 50 + 0.1,
                direction: Math.random() * Math.PI * 2,
                gravity: 0.1
            }
            particles.push(Particle.create(particleSettings));
        }

        // Demo player
        player = AnimationPlayer.create();        
        player.setUpdateFn(update);
        player.play();


        // Frame drawing function
        function update() {
            ctx.clearRect(0,0, width, height);

            for (var i=0;i<numParticles;i++) {
                var p = particles[i];
                p.update();

                ctx.beginPath();
                ctx.arc(p.position.getX(), p.position.getY(), 4, 0, Math.PI * 2, false);
                ctx.fill();
                ctx.closePath();
            }          
        }
    };

    // Animation control
    document.onkeyup = function(e) {
        switch (e.keyCode) {
            case 27: // Esc
                if (requestId) {
                    window.cancelAnimationFrame(requestId);
                    requestId = undefined;
                    console.log("> Scene stopped");
                }
                break;      
        }
    };
    </script>
    <script src="../lib/Vector.js" type="text/javascript"></script>
    <script src="../lib/Particle.js" type="text/javascript"></script>
    <script src="../lib/AnimationPlayer.js" type="text/javascript"></script>
    </head>
<body>
<canvas id="canvas"></canvas>
</body>
</html>